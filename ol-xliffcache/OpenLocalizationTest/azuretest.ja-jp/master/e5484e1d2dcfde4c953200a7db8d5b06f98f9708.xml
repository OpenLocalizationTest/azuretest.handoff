<markdown_skeleton_root>
  <block_element>
    <ArrayOfMarkdownBlockBase xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <MarkdownBlockBase
        xsi:type="MarkdownAzureMetadataBlock"
        item_id="6d4d7c67-f005-4e4c-9bd6-c74d409842be"
        item_type="AzureMetadata"
        item_footer="footer_not_set"
        trans_unit_id="6d4d7c67-f005-4e4c-9bd6-c74d409842be">
        <LocalizeItemList>
          <MarkdownInternalXmlItem
            internal_item_id="2e73e09b-a111-45f8-9b71-b03af9697071"
            trans_unit_id="101"
            internal_item_type="Xml">
            <internal_items />
          </MarkdownInternalXmlItem>
          <MarkdownInternalXmlItem
            internal_item_id="a1a904a1-8499-46f3-bdbe-0fa99d7d1fbb"
            trans_unit_id="102"
            internal_item_type="Xml">
            <internal_items />
          </MarkdownInternalXmlItem>
        </LocalizeItemList>
        <ItemValue>&lt;properties
   pageTitle="2e73e09b-a111-45f8-9b71-b03af9697071"
   description="a1a904a1-8499-46f3-bdbe-0fa99d7d1fbb"
   services="sql-data-warehouse"
   documentationCenter="NA"
   authors="jrowlandjones"
   manager="barbkess"
   editor=""/&gt;

&lt;tags
   ms.service="sql-data-warehouse"
   ms.devlang="NA"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="data-services"
   ms.date="06/26/2015"
   ms.author="JRJ@BigBangData.co.uk;barbkess"/&gt;

</ItemValue>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="3893da03-a094-455e-97a2-d9cac1399d38"
        item_type="Header"
        item_footer="footer_not_set"
        trans_unit_id="3893da03-a094-455e-97a2-d9cac1399d38">
        <segment
          trans_unit_id="103">
          <SegmentId>0dfd0f70-b695-4420-bb60-f469a2825e7c</SegmentId>
          <InternalNormalItem
            internal_item_id="1"
            internal_item_parent_id="103"
            trans_unit_id="103-1"
            internal_item_type="Normal">
            <internal_items />
          </InternalNormalItem>
        </segment>
        <header_type>Star</header_type>
        <header_level>1</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="705d4f70-b208-4684-b7be-c1cf563becdd"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="705d4f70-b208-4684-b7be-c1cf563becdd">
        <Lines>
          <MarkdownLine>
            <LineId>27f4f4e0-ef06-40af-b58d-68dfb7d08373</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="104">
                <SegmentId>f11fce1b-1720-4929-9c50-062415b07bdf</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="104"
                  trans_unit_id="104-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="105">
                <SegmentId>ac6382bc-3439-4cf0-a92e-005ade7a8100</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="105"
                  trans_unit_id="105-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="104">
            <SegmentId>f11fce1b-1720-4929-9c50-062415b07bdf</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="104"
              trans_unit_id="104-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="105">
            <SegmentId>ac6382bc-3439-4cf0-a92e-005ade7a8100</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="105"
              trans_unit_id="105-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="6ec950b3-7ac6-4e3c-902b-7846a4585537"
        item_type="NormalParagraph"
        item_footer="footer_not_set"
        trans_unit_id="6ec950b3-7ac6-4e3c-902b-7846a4585537">
        <Lines>
          <MarkdownLine>
            <LineId>fe3781f1-1fe2-4089-96dd-e3b7d4afb8dd</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="106">
                <SegmentId>85c64ef1-25ae-4f7b-9209-fd8638c4cf7b</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="106"
                  trans_unit_id="106-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="106">
            <SegmentId>85c64ef1-25ae-4f7b-9209-fd8638c4cf7b</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="106"
              trans_unit_id="106-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownListBlock"
        item_id="4f1858ed-96b1-46a1-a60e-acb56d781c4d"
        item_type="List"
        item_footer=""
        trans_unit_id="4f1858ed-96b1-46a1-a60e-acb56d781c4d">
        <inner_list_items>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="55b39b2c-36b6-40e5-a407-56acd0af8a99"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="55b39b2c-36b6-40e5-a407-56acd0af8a99">
              <Lines>
                <MarkdownLine>
                  <LineId>725e4736-830c-4e79-9f6c-acfe47fcca21</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="107">
                      <SegmentId>21c47172-b82f-41d1-ba0a-572c737e0338</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="107"
                        trans_unit_id="107-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="107">
                  <SegmentId>21c47172-b82f-41d1-ba0a-572c737e0338</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="107"
                    trans_unit_id="107-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="082ee74b-b3a0-4bb7-b604-dcbf270ad0c5"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="082ee74b-b3a0-4bb7-b604-dcbf270ad0c5">
              <Lines>
                <MarkdownLine>
                  <LineId>70913592-7d32-412e-a97c-8240a17a26c9</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="108">
                      <SegmentId>20f8c62b-b1bc-4189-990d-5990cff5559b</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="108"
                        trans_unit_id="108-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="108">
                  <SegmentId>20f8c62b-b1bc-4189-990d-5990cff5559b</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="108"
                    trans_unit_id="108-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="f89e7226-2916-4adc-b264-5e06cf11a76f"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="f89e7226-2916-4adc-b264-5e06cf11a76f">
              <Lines>
                <MarkdownLine>
                  <LineId>48eb6b8e-0e23-4091-b06d-b6d789615691</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="109">
                      <SegmentId>0a1db73e-87f6-4a1a-a5d8-2f74057b1aae</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="109"
                        trans_unit_id="109-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="109">
                  <SegmentId>0a1db73e-87f6-4a1a-a5d8-2f74057b1aae</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="109"
                    trans_unit_id="109-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
        </inner_list_items>
        <ListType>Charactor</ListType>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="2e09ca00-0246-443d-beea-fbabbb617d70"
        item_type="Header"
        item_footer="footer_not_set"
        trans_unit_id="2e09ca00-0246-443d-beea-fbabbb617d70">
        <segment
          trans_unit_id="110">
          <SegmentId>bf9aea53-a555-4c61-96e5-5459c0d6ee80</SegmentId>
          <InternalNormalItem
            internal_item_id="1"
            internal_item_parent_id="110"
            trans_unit_id="110-1"
            internal_item_type="Normal">
            <internal_items />
          </InternalNormalItem>
        </segment>
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="cbf324c3-cd63-4bf6-9da0-06e1f331aecd"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="cbf324c3-cd63-4bf6-9da0-06e1f331aecd">
        <Lines>
          <MarkdownLine>
            <LineId>bdce2c24-5d9f-48ed-8453-fae931628371</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="111">
                <SegmentId>2a15481e-3637-4b37-bf6a-838ae1c22ad2</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="111"
                  trans_unit_id="111-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
                <CodeSpanItem
                  internal_item_id="2"
                  internal_item_parent_id="111"
                  trans_unit_id="111-2"
                  internal_item_type="CodeSpan">
                  <internal_items />
                  <ItemValue>UNION ALL</ItemValue>
                </CodeSpanItem>
                <InternalNormalItem
                  internal_item_id="3"
                  internal_item_parent_id="111"
                  trans_unit_id="111-3"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="112">
                <SegmentId>92480013-29c3-4f4a-ae30-aefba9542ec6</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="112"
                  trans_unit_id="112-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="111">
            <SegmentId>2a15481e-3637-4b37-bf6a-838ae1c22ad2</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="111"
              trans_unit_id="111-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
            <CodeSpanItem
              internal_item_id="2"
              internal_item_parent_id="111"
              trans_unit_id="111-2"
              internal_item_type="CodeSpan">
              <internal_items />
              <ItemValue>UNION ALL</ItemValue>
            </CodeSpanItem>
            <InternalNormalItem
              internal_item_id="3"
              internal_item_parent_id="111"
              trans_unit_id="111-3"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="112">
            <SegmentId>92480013-29c3-4f4a-ae30-aefba9542ec6</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="112"
              trans_unit_id="112-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="9ff3bee6-930a-45ef-9401-7d998e4e1ed7"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="9ff3bee6-930a-45ef-9401-7d998e4e1ed7">
        <Lines>
          <MarkdownLine>
            <LineId>ae775903-36eb-4720-a9c0-9dc243da0ffa</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="113">
                <SegmentId>20f61fec-1ae0-4736-9764-89e16730f842</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="113"
                  trans_unit_id="113-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
                <CodeSpanItem
                  internal_item_id="2"
                  internal_item_parent_id="113"
                  trans_unit_id="113-2"
                  internal_item_type="CodeSpan">
                  <internal_items />
                  <ItemValue>ROLLUP</ItemValue>
                </CodeSpanItem>
                <InternalNormalItem
                  internal_item_id="3"
                  internal_item_parent_id="113"
                  trans_unit_id="113-3"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="113">
            <SegmentId>20f61fec-1ae0-4736-9764-89e16730f842</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="113"
              trans_unit_id="113-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
            <CodeSpanItem
              internal_item_id="2"
              internal_item_parent_id="113"
              trans_unit_id="113-2"
              internal_item_type="CodeSpan">
              <internal_items />
              <ItemValue>ROLLUP</ItemValue>
            </CodeSpanItem>
            <InternalNormalItem
              internal_item_id="3"
              internal_item_parent_id="113"
              trans_unit_id="113-3"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="f4cfc68a-acef-4b96-8b1d-8abb29b34a2a"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="f4cfc68a-acef-4b96-8b1d-8abb29b34a2a">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>SELECT [SalesTerritoryCountry]
,      [SalesTerritoryRegion]
,      SUM(SalesAmount)             AS TotalSalesAmount
FROM  dbo.factInternetSales s
JOIN  dbo.DimSalesTerritory t       ON s.SalesTerritoryKey       = t.SalesTerritoryKey
GROUP BY ROLLUP (
                        [SalesTerritoryCountry]
                ,       [SalesTerritoryRegion]
                )
;</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="1bc08507-2648-4148-bdbf-4b50dc72dbc5"
        item_type="NormalParagraph"
        item_footer="footer_not_set"
        trans_unit_id="1bc08507-2648-4148-bdbf-4b50dc72dbc5">
        <Lines>
          <MarkdownLine>
            <LineId>5fc98031-a55d-4534-a9d5-90734c22f03f</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="114">
                <SegmentId>b420dfa5-0cf4-4608-9092-37212d357113</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="114"
                  trans_unit_id="114-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="114">
            <SegmentId>b420dfa5-0cf4-4608-9092-37212d357113</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="114"
              trans_unit_id="114-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownListBlock"
        item_id="b43bf65b-5943-4e22-8953-fde057222cb0"
        item_type="List"
        item_footer=""
        trans_unit_id="b43bf65b-5943-4e22-8953-fde057222cb0">
        <inner_list_items>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="5a41ff00-f8d4-41cf-9e25-689a98f79e4b"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="5a41ff00-f8d4-41cf-9e25-689a98f79e4b">
              <Lines>
                <MarkdownLine>
                  <LineId>6ca6fc4d-d485-4520-946b-fd9304156327</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="115">
                      <SegmentId>5fe779bf-fd85-469b-bedb-bf741d54d79c</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="115"
                        trans_unit_id="115-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="115">
                  <SegmentId>5fe779bf-fd85-469b-bedb-bf741d54d79c</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="115"
                    trans_unit_id="115-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="06ade695-e0ea-4833-bb31-ac7a43c5d198"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="06ade695-e0ea-4833-bb31-ac7a43c5d198">
              <Lines>
                <MarkdownLine>
                  <LineId>7288ea9d-4475-4f7f-b298-06a350e12106</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="116">
                      <SegmentId>d09cfc59-69d5-410e-a19a-745785c380fc</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="116"
                        trans_unit_id="116-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="116">
                  <SegmentId>d09cfc59-69d5-410e-a19a-745785c380fc</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="116"
                    trans_unit_id="116-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="475f0b99-9b67-41cc-b09b-f7ebdb8d1c28"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="475f0b99-9b67-41cc-b09b-f7ebdb8d1c28">
              <Lines>
                <MarkdownLine>
                  <LineId>4183adb2-bbe6-4e2c-baba-479631f01f2a</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="117">
                      <SegmentId>79c379cd-3225-4148-9b5a-af10eb31486c</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="117"
                        trans_unit_id="117-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="117">
                  <SegmentId>79c379cd-3225-4148-9b5a-af10eb31486c</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="117"
                    trans_unit_id="117-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
        </inner_list_items>
        <ListType>Charactor</ListType>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="1ce40a01-3299-4b25-b25c-8f17737a5b31"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="1ce40a01-3299-4b25-b25c-8f17737a5b31">
        <Lines>
          <MarkdownLine>
            <LineId>2c6cdfc4-3096-47b5-81a9-ac6a0656574f</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="118">
                <SegmentId>91bc604f-29fa-4d4a-ab04-5d32296343df</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="118"
                  trans_unit_id="118-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
                <CodeSpanItem
                  internal_item_id="2"
                  internal_item_parent_id="118"
                  trans_unit_id="118-2"
                  internal_item_type="CodeSpan">
                  <internal_items />
                  <ItemValue>UNION ALL</ItemValue>
                </CodeSpanItem>
                <InternalNormalItem
                  internal_item_id="3"
                  internal_item_parent_id="118"
                  trans_unit_id="118-3"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="118">
            <SegmentId>91bc604f-29fa-4d4a-ab04-5d32296343df</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="118"
              trans_unit_id="118-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
            <CodeSpanItem
              internal_item_id="2"
              internal_item_parent_id="118"
              trans_unit_id="118-2"
              internal_item_type="CodeSpan">
              <internal_items />
              <ItemValue>UNION ALL</ItemValue>
            </CodeSpanItem>
            <InternalNormalItem
              internal_item_id="3"
              internal_item_parent_id="118"
              trans_unit_id="118-3"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="b567a0e8-0837-4da2-bd5c-1f20548467d7"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="b567a0e8-0837-4da2-bd5c-1f20548467d7">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>SELECT [SalesTerritoryCountry]
,      [SalesTerritoryRegion]
,      SUM(SalesAmount) AS TotalSalesAmount
FROM  dbo.factInternetSales s
JOIN  dbo.DimSalesTerritory t     ON s.SalesTerritoryKey       = t.SalesTerritoryKey
GROUP BY 
       [SalesTerritoryCountry]
,      [SalesTerritoryRegion]
UNION ALL
SELECT [SalesTerritoryCountry]
,      NULL
,      SUM(SalesAmount) AS TotalSalesAmount
FROM  dbo.factInternetSales s
JOIN  dbo.DimSalesTerritory t     ON s.SalesTerritoryKey       = t.SalesTerritoryKey
GROUP BY 
       [SalesTerritoryCountry]
UNION ALL
SELECT NULL
,      NULL
,      SUM(SalesAmount) AS TotalSalesAmount
FROM  dbo.factInternetSales s
JOIN  dbo.DimSalesTerritory t     ON s.SalesTerritoryKey       = t.SalesTerritoryKey;</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="dd5a8b83-f1c1-477e-a0fe-d25ee1b29866"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="dd5a8b83-f1c1-477e-a0fe-d25ee1b29866">
        <Lines>
          <MarkdownLine>
            <LineId>78ee8c87-a165-41f8-853c-3d405ed02d2e</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="119">
                <SegmentId>dc2cf508-01ec-44bb-8591-9a352965b55c</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="119"
                  trans_unit_id="119-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="119">
            <SegmentId>dc2cf508-01ec-44bb-8591-9a352965b55c</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="119"
              trans_unit_id="119-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="80591db6-f530-42d0-9d1c-0ccf0ea69918"
        item_type="Header"
        item_footer="footer_not_set"
        trans_unit_id="80591db6-f530-42d0-9d1c-0ccf0ea69918">
        <segment
          trans_unit_id="120">
          <SegmentId>62e0e1f2-09d7-4a26-957f-0f179574db76</SegmentId>
          <InternalNormalItem
            internal_item_id="1"
            internal_item_parent_id="120"
            trans_unit_id="120-1"
            internal_item_type="Normal">
            <internal_items />
          </InternalNormalItem>
        </segment>
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="37cc57ef-ee61-4720-b2d3-65c111ced615"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="37cc57ef-ee61-4720-b2d3-65c111ced615">
        <Lines>
          <MarkdownLine>
            <LineId>08dd1691-53cc-43e5-a2c9-1f7f8900fe0d</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="121">
                <SegmentId>9e008d9a-e9f2-4af7-82d1-5065497ae50a</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="121"
                  trans_unit_id="121-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="122">
                <SegmentId>e3dff309-361c-476b-acb5-be226870bd70</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="122"
                  trans_unit_id="122-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="123">
                <SegmentId>4da1af88-8c2c-46d5-adc3-c2fec090267f</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="123"
                  trans_unit_id="123-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="121">
            <SegmentId>9e008d9a-e9f2-4af7-82d1-5065497ae50a</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="121"
              trans_unit_id="121-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="122">
            <SegmentId>e3dff309-361c-476b-acb5-be226870bd70</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="122"
              trans_unit_id="122-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="123">
            <SegmentId>4da1af88-8c2c-46d5-adc3-c2fec090267f</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="123"
              trans_unit_id="123-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="b09b062f-bff5-4708-a4d9-766707fdb8b3"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="b09b062f-bff5-4708-a4d9-766707fdb8b3">
        <Lines>
          <MarkdownLine>
            <LineId>85c0b528-9013-47e9-ab3b-2b921abb98e8</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="124">
                <SegmentId>a3684f33-5b5d-4650-a41e-514e666b0966</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="124"
                  trans_unit_id="124-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="124">
            <SegmentId>a3684f33-5b5d-4650-a41e-514e666b0966</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="124"
              trans_unit_id="124-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="bd7ed7b5-92ae-4ccf-8e46-17430a87bb19"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="bd7ed7b5-92ae-4ccf-8e46-17430a87bb19">
        <Lines>
          <MarkdownLine>
            <LineId>f507774b-3e10-48b6-bd80-c3c02e579ff7</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="125">
                <SegmentId>d94064c7-51f9-41dd-b525-080b34d3e5cb</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="125"
                  trans_unit_id="125-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="126">
                <SegmentId>c3516b70-3247-4504-be04-a287c674cc1e</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="126"
                  trans_unit_id="126-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="127">
                <SegmentId>fa9dde34-2cb2-4f7f-87ff-891c32365e15</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="127"
                  trans_unit_id="127-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="128">
                <SegmentId>69e1c89d-3433-436c-807c-aadd8f6c1744</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="128"
                  trans_unit_id="128-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="125">
            <SegmentId>d94064c7-51f9-41dd-b525-080b34d3e5cb</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="125"
              trans_unit_id="125-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="126">
            <SegmentId>c3516b70-3247-4504-be04-a287c674cc1e</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="126"
              trans_unit_id="126-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="127">
            <SegmentId>fa9dde34-2cb2-4f7f-87ff-891c32365e15</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="127"
              trans_unit_id="127-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="128">
            <SegmentId>69e1c89d-3433-436c-807c-aadd8f6c1744</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="128"
              trans_unit_id="128-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="e3e93bf0-e8bd-4e56-9746-e87a10b58e8f"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="e3e93bf0-e8bd-4e56-9746-e87a10b58e8f">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>CREATE TABLE #Cube
WITH 
(   DISTRIBUTION = ROUND_ROBIN
,   LOCATION = USER_DB
)
AS
WITH GrpCube AS
(SELECT    CAST(ISNULL(Country,'NULL')+','+ISNULL(Region,'NULL') AS NVARCHAR(50)) as 'Cols'
,          CAST(ISNULL(Country+',','')+ISNULL(Region,'') AS NVARCHAR(50))  as 'GroupBy'
,          ROW_NUMBER() OVER (ORDER BY Country) as 'Seq'
FROM       ( SELECT 'SalesTerritoryCountry' as Country
             UNION ALL
             SELECT NULL
           ) c
CROSS JOIN ( SELECT 'SalesTerritoryRegion' as Region
             UNION ALL
             SELECT NULL
           ) r
)
SELECT Cols
,      CASE WHEN SUBSTRING(GroupBy,LEN(GroupBy),1) = ',' 
            THEN SUBSTRING(GroupBy,1,LEN(GroupBy)-1) 
            ELSE GroupBy 
       END AS GroupBy  --Remove Trailing Comma
,Seq
FROM GrpCube;</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="b8e2c3ec-51b0-41cf-afda-d02b02f1922e"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="b8e2c3ec-51b0-41cf-afda-d02b02f1922e">
        <Lines>
          <MarkdownLine>
            <LineId>90222ee1-b56d-4782-bf6f-bbca663506c5</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="129">
                <SegmentId>76c40794-ba6a-4b72-a1f6-64e5b6e06ea8</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="129"
                  trans_unit_id="129-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="129">
            <SegmentId>76c40794-ba6a-4b72-a1f6-64e5b6e06ea8</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="129"
              trans_unit_id="129-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="291ef95b-13f5-4160-ba08-77a8262a8598"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="291ef95b-13f5-4160-ba08-77a8262a8598">
        <Lines>
          <MarkdownLine>
            <LineId>1d46e7c5-4e13-4f9f-8ff4-f0a0badc3013</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="130">
                <SegmentId>4f2d0335-742f-416e-819a-016450358e14</SegmentId>
                <ImageItem
                  internal_item_id="1"
                  internal_item_parent_id="130"
                  trans_unit_id="130-1"
                  internal_item_type="Image">
                  <internal_items />
                  <internal_Image_type>Reference</internal_Image_type>
                  <internal_link_text />
                  <internal_link_id>1</internal_link_id>
                </ImageItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="130">
            <SegmentId>4f2d0335-742f-416e-819a-016450358e14</SegmentId>
            <ImageItem
              internal_item_id="1"
              internal_item_parent_id="130"
              trans_unit_id="130-1"
              internal_item_type="Image">
              <internal_items />
              <internal_Image_type>Reference</internal_Image_type>
              <internal_link_text />
              <internal_link_id>1</internal_link_id>
            </ImageItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="3eb3d4d7-afff-4e59-8f86-1a3d3cb90ac4"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="3eb3d4d7-afff-4e59-8f86-1a3d3cb90ac4">
        <Lines>
          <MarkdownLine>
            <LineId>7cdba35e-0676-46cc-9496-28f914770deb</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="131">
                <SegmentId>008ad5ea-10b0-41b2-8748-8c2545af9180</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="131"
                  trans_unit_id="131-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="131">
            <SegmentId>008ad5ea-10b0-41b2-8748-8c2545af9180</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="131"
              trans_unit_id="131-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="dab0ee2c-8074-475e-ae05-a8fe2c80d87f"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="dab0ee2c-8074-475e-ae05-a8fe2c80d87f">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block> @SQL NVARCHAR(4000)
,@Columns NVARCHAR(4000)
,@GroupBy NVARCHAR(4000)
,@i INT = 1
,@nbr INT = 0
;
CREATE TABLE #Results
(
 [SalesTerritoryCountry] NVARCHAR(50)
,[SalesTerritoryRegion]  NVARCHAR(50)
,[TotalSalesAmount]      MONEY
)
WITH
(   DISTRIBUTION = ROUND_ROBIN
,   LOCATION = USER_DB
)
;</code_block>
        <fenced_code_lang>
DECLARE </fenced_code_lang>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="590e4e7a-ce68-452c-a37a-94184dcc19bb"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="590e4e7a-ce68-452c-a37a-94184dcc19bb">
        <Lines>
          <MarkdownLine>
            <LineId>3272231b-db55-49a9-bd41-43ed7755eaf2</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="132">
                <SegmentId>e2b7250e-564b-4cd2-86c0-3fb9bf6b5876</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="132"
                  trans_unit_id="132-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="133">
                <SegmentId>d0ee51b6-7cbc-4676-be4c-f7264b10fc62</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="133"
                  trans_unit_id="133-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="132">
            <SegmentId>e2b7250e-564b-4cd2-86c0-3fb9bf6b5876</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="132"
              trans_unit_id="132-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="133">
            <SegmentId>d0ee51b6-7cbc-4676-be4c-f7264b10fc62</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="133"
              trans_unit_id="133-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="e7546f6f-0a8f-48c8-9e5b-2f3bd3af54a7"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="e7546f6f-0a8f-48c8-9e5b-2f3bd3af54a7">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>SET @nbr =(SELECT MAX(Seq) FROM #Cube);

WHILE @i&lt;=@nbr
BEGIN
    SET @Columns = (SELECT Cols    FROM #Cube where seq = @i);
    SET @GroupBy = (SELECT GroupBy FROM #Cube where seq = @i);

    SET @SQL ='INSERT INTO #Results
              SELECT '+@Columns+'
              ,      SUM(SalesAmount) AS TotalSalesAmount
              FROM  dbo.factInternetSales s
              JOIN  dbo.DimSalesTerritory t  
              ON s.SalesTerritoryKey = t.SalesTerritoryKey
              '+CASE WHEN @GroupBy &lt;&gt;'' 
                     THEN 'GROUP BY '+@GroupBy ELSE '' END

    EXEC sp_executesql @SQL;
    SET @i +=1;
END</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="8d647165-fd42-40a2-b1de-e193893f22d8"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="8d647165-fd42-40a2-b1de-e193893f22d8">
        <Lines>
          <MarkdownLine>
            <LineId>bb1f2678-c843-49ee-8877-770975fa0824</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="134">
                <SegmentId>f64e755c-7c95-4e6c-bcef-ba43c63e9465</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="134"
                  trans_unit_id="134-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="134">
            <SegmentId>f64e755c-7c95-4e6c-bcef-ba43c63e9465</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="134"
              trans_unit_id="134-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="c1c9dd6a-778b-4bec-b538-7ea7951ab9e8"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="c1c9dd6a-778b-4bec-b538-7ea7951ab9e8">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>SELECT * 
FROM #Results
ORDER BY 1,2,3
;</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="12370cd6-4041-4fba-8641-342e962fc353"
        item_type="NormalParagraph"
        item_footer="&#xA;"
        trans_unit_id="12370cd6-4041-4fba-8641-342e962fc353">
        <Lines>
          <MarkdownLine>
            <LineId>c29d107f-2285-4ca3-b0a8-b5127151f9b8</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="135">
                <SegmentId>25b21b65-ffde-4a25-9d21-e767eaacf02f</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="135"
                  trans_unit_id="135-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="135">
            <SegmentId>25b21b65-ffde-4a25-9d21-e767eaacf02f</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="135"
              trans_unit_id="135-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="beb03a38-cc24-471c-9bb7-2c629dd8f2aa"
        item_type="Header"
        item_footer="footer_not_set"
        trans_unit_id="beb03a38-cc24-471c-9bb7-2c629dd8f2aa">
        <segment
          trans_unit_id="136">
          <SegmentId>073bf1f3-77da-40d7-a7d0-30e72f2bee6b</SegmentId>
          <InternalNormalItem
            internal_item_id="1"
            internal_item_parent_id="136"
            trans_unit_id="136-1"
            internal_item_type="Normal">
            <internal_items />
          </InternalNormalItem>
        </segment>
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="8e6541dd-6100-4d09-89cb-dd4a0a051626"
        item_type="NormalParagraph"
        item_footer="&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;"
        trans_unit_id="8e6541dd-6100-4d09-89cb-dd4a0a051626">
        <Lines>
          <MarkdownLine>
            <LineId>54983c1a-5fed-4f99-ba53-ef6be0499a59</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="137">
                <SegmentId>b74da966-f46e-47a8-80f7-cd3ce8b526a7</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="137"
                  trans_unit_id="137-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
                <LinkItem
                  internal_item_id="2"
                  internal_item_parent_id="137"
                  trans_unit_id="137-2"
                  internal_item_type="Link">
                  <internal_items />
                  <internal_link_type>Reference</internal_link_type>
                  <internal_link_text>development overview</internal_link_text>
                  <internal_link_id />
                </LinkItem>
                <InternalNormalItem
                  internal_item_id="3"
                  internal_item_parent_id="137"
                  trans_unit_id="137-3"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="137">
            <SegmentId>b74da966-f46e-47a8-80f7-cd3ce8b526a7</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="137"
              trans_unit_id="137-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
            <LinkItem
              internal_item_id="2"
              internal_item_parent_id="137"
              trans_unit_id="137-2"
              internal_item_type="Link">
              <internal_items />
              <internal_link_type>Reference</internal_link_type>
              <internal_link_text>development overview</internal_link_text>
              <internal_link_id />
            </LinkItem>
            <InternalNormalItem
              internal_item_id="3"
              internal_item_parent_id="137"
              trans_unit_id="137-3"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
    </ArrayOfMarkdownBlockBase>
  </block_element>
  <references>
    <ArrayOfMarkdownLinkedReference xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <MarkdownLinkedReference
        item_id="e70dc01d-c566-4714-b628-365759cf6057"
        item_type="LinkedReference"
        item_footer="footer_not_set"
        trans_unit_id="e70dc01d-c566-4714-b628-365759cf6057">
        <link_id>1</link_id>
        <link_uri>media/sql-data-warehouse-develop-group-by-options/sql-data-warehouse-develop-group-by-cube.png</link_uri>
        <link_title />
      </MarkdownLinkedReference>
      <MarkdownLinkedReference
        item_id="9df65ec7-4d5c-41a3-a3f8-15d94633cfb6"
        item_type="LinkedReference"
        item_footer="footer_not_set"
        trans_unit_id="9df65ec7-4d5c-41a3-a3f8-15d94633cfb6">
        <link_id>development overview</link_id>
        <link_uri>sql-data-warehouse-overview-develop.md</link_uri>
        <link_title />
      </MarkdownLinkedReference>
      <MarkdownLinkedReference
        item_id="c54f28fa-9b89-4036-904f-7bff71482e07"
        item_type="LinkedReference"
        item_footer="footer_not_set"
        trans_unit_id="c54f28fa-9b89-4036-904f-7bff71482e07">
        <link_id>group by</link_id>
        <link_uri>https://msdn.microsoft.com/en-us/library/ms177673.aspx</link_uri>
        <link_title />
      </MarkdownLinkedReference>
    </ArrayOfMarkdownLinkedReference>
  </references>
</markdown_skeleton_root>