<markdown_skeleton_root>
  <block_element>
    <ArrayOfMarkdownBlockBase xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <MarkdownBlockBase
        xsi:type="MarkdownAzureMetadataBlock"
        item_id="e3ecf130-49ae-455a-92ab-aaf554fcba17"
        item_type="AzureMetadata"
        item_footer="footer_not_set"
        trans_unit_id="e3ecf130-49ae-455a-92ab-aaf554fcba17">
        <LocalizeItemList>
          <MarkdownInternalXmlItem
            internal_item_id="2ab378f2-9ac1-45c1-aa59-9df86ac8c770"
            trans_unit_id="101"
            internal_item_type="Xml">
            <internal_items />
          </MarkdownInternalXmlItem>
          <MarkdownInternalXmlItem
            internal_item_id="ae167c65-4da1-4b37-84c0-7a392735782e"
            trans_unit_id="102"
            internal_item_type="Xml">
            <internal_items />
          </MarkdownInternalXmlItem>
        </LocalizeItemList>
        <ItemValue>&lt;properties
   pageTitle="2ab378f2-9ac1-45c1-aa59-9df86ac8c770"
   description="ae167c65-4da1-4b37-84c0-7a392735782e"
   services="sql-data-warehouse"
   documentationCenter="NA"
   authors="jrowlandjones"
   manager="barbkess"
   editor=""/&gt;

&lt;tags
   ms.service="sql-data-warehouse"
   ms.devlang="NA"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="data-services"
   ms.date="06/26/2015"
   ms.author="JRJ@BigBangData.co.uk;barbkess"/&gt;

</ItemValue>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="484a3dcf-59e9-4dad-a85f-688aad5c54ad"
        item_type="Header"
        item_footer="footer_not_set"
        trans_unit_id="484a3dcf-59e9-4dad-a85f-688aad5c54ad">
        <segment
          trans_unit_id="103">
          <SegmentId>cf9bb106-7193-41ee-b0a8-b992584ade0e</SegmentId>
          <InternalNormalItem
            internal_item_id="1"
            internal_item_parent_id="103"
            trans_unit_id="103-1"
            internal_item_type="Normal">
            <internal_items />
          </InternalNormalItem>
        </segment>
        <header_type>Star</header_type>
        <header_level>1</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="bdf557f2-c9ce-48fb-8016-b65495e1cb36"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="bdf557f2-c9ce-48fb-8016-b65495e1cb36">
        <Lines>
          <MarkdownLine>
            <LineId>6f4b04a3-643f-49c4-8b63-a46b2926c777</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="104">
                <SegmentId>5b067aa5-cb7c-4efd-86c1-ac20600c8944</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="104"
                  trans_unit_id="104-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="105">
                <SegmentId>9fe91ddc-00ec-4cee-8b5a-2d50f5fd278a</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="105"
                  trans_unit_id="105-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="104">
            <SegmentId>5b067aa5-cb7c-4efd-86c1-ac20600c8944</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="104"
              trans_unit_id="104-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="105">
            <SegmentId>9fe91ddc-00ec-4cee-8b5a-2d50f5fd278a</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="105"
              trans_unit_id="105-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="b9f26208-696d-44ab-a63c-58a3d0ca6cd6"
        item_type="NormalParagraph"
        item_footer="footer_not_set"
        trans_unit_id="b9f26208-696d-44ab-a63c-58a3d0ca6cd6">
        <Lines>
          <MarkdownLine>
            <LineId>0109c628-1160-4e6b-b25a-0a6368dd5ab5</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="106">
                <SegmentId>ea23231d-5223-4aba-9f16-7ac14dd4ac34</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="106"
                  trans_unit_id="106-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="106">
            <SegmentId>ea23231d-5223-4aba-9f16-7ac14dd4ac34</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="106"
              trans_unit_id="106-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownListBlock"
        item_id="614522b5-a2da-4d2a-829e-62c32826a2e0"
        item_type="List"
        item_footer=""
        trans_unit_id="614522b5-a2da-4d2a-829e-62c32826a2e0">
        <inner_list_items>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="39d03909-6061-436d-a7f9-924e3ddd4f1d"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="39d03909-6061-436d-a7f9-924e3ddd4f1d">
              <Lines>
                <MarkdownLine>
                  <LineId>5b98415d-1d90-4b53-84dc-876d2ed744ee</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="107">
                      <SegmentId>c2e18af8-7d62-4d7d-9a85-5f9ba125036b</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="107"
                        trans_unit_id="107-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="107">
                  <SegmentId>c2e18af8-7d62-4d7d-9a85-5f9ba125036b</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="107"
                    trans_unit_id="107-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="1d742ea2-5597-450b-95a5-1f7846686d19"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="1d742ea2-5597-450b-95a5-1f7846686d19">
              <Lines>
                <MarkdownLine>
                  <LineId>3fe285f6-a621-4129-9f58-80761b33f43a</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="108">
                      <SegmentId>87cba134-ae85-498f-bf2d-08078f721c5f</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="108"
                        trans_unit_id="108-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="108">
                  <SegmentId>87cba134-ae85-498f-bf2d-08078f721c5f</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="108"
                    trans_unit_id="108-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="e7ab33fa-1495-4360-8a21-67082726a017"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="e7ab33fa-1495-4360-8a21-67082726a017">
              <Lines>
                <MarkdownLine>
                  <LineId>19495cae-1036-4c5c-9e38-332fa7f8b560</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="109">
                      <SegmentId>9f96a3a7-d025-48d1-a2d6-63aa0d10b54e</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="109"
                        trans_unit_id="109-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="109">
                  <SegmentId>9f96a3a7-d025-48d1-a2d6-63aa0d10b54e</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="109"
                    trans_unit_id="109-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
        </inner_list_items>
        <ListType>Charactor</ListType>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="92efc971-5a84-481a-884e-238e2cf72638"
        item_type="Header"
        item_footer="footer_not_set"
        trans_unit_id="92efc971-5a84-481a-884e-238e2cf72638">
        <segment
          trans_unit_id="110">
          <SegmentId>644f0f7c-8347-4148-9fdc-562f5ac19ae7</SegmentId>
          <InternalNormalItem
            internal_item_id="1"
            internal_item_parent_id="110"
            trans_unit_id="110-1"
            internal_item_type="Normal">
            <internal_items />
          </InternalNormalItem>
        </segment>
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="29aa00af-ca74-4701-8dc3-560506636eb0"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="29aa00af-ca74-4701-8dc3-560506636eb0">
        <Lines>
          <MarkdownLine>
            <LineId>b260649a-52d8-4b37-8886-fac7414e1248</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="111">
                <SegmentId>18c58dd0-7df2-489c-9751-b10e48f40c0e</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="111"
                  trans_unit_id="111-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
                <CodeSpanItem
                  internal_item_id="2"
                  internal_item_parent_id="111"
                  trans_unit_id="111-2"
                  internal_item_type="CodeSpan">
                  <internal_items />
                  <ItemValue>UNION ALL</ItemValue>
                </CodeSpanItem>
                <InternalNormalItem
                  internal_item_id="3"
                  internal_item_parent_id="111"
                  trans_unit_id="111-3"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="112">
                <SegmentId>fa43af1c-77c7-4a89-9e43-b3d96097c155</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="112"
                  trans_unit_id="112-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="111">
            <SegmentId>18c58dd0-7df2-489c-9751-b10e48f40c0e</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="111"
              trans_unit_id="111-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
            <CodeSpanItem
              internal_item_id="2"
              internal_item_parent_id="111"
              trans_unit_id="111-2"
              internal_item_type="CodeSpan">
              <internal_items />
              <ItemValue>UNION ALL</ItemValue>
            </CodeSpanItem>
            <InternalNormalItem
              internal_item_id="3"
              internal_item_parent_id="111"
              trans_unit_id="111-3"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="112">
            <SegmentId>fa43af1c-77c7-4a89-9e43-b3d96097c155</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="112"
              trans_unit_id="112-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="8b6ac5c1-e3bc-474f-a2bb-04982b9c0e44"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="8b6ac5c1-e3bc-474f-a2bb-04982b9c0e44">
        <Lines>
          <MarkdownLine>
            <LineId>15b14973-82c5-4a4e-8c18-7c51c35ac25f</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="113">
                <SegmentId>59341663-0c98-4121-acf2-f687f6153288</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="113"
                  trans_unit_id="113-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
                <CodeSpanItem
                  internal_item_id="2"
                  internal_item_parent_id="113"
                  trans_unit_id="113-2"
                  internal_item_type="CodeSpan">
                  <internal_items />
                  <ItemValue>ROLLUP</ItemValue>
                </CodeSpanItem>
                <InternalNormalItem
                  internal_item_id="3"
                  internal_item_parent_id="113"
                  trans_unit_id="113-3"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="113">
            <SegmentId>59341663-0c98-4121-acf2-f687f6153288</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="113"
              trans_unit_id="113-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
            <CodeSpanItem
              internal_item_id="2"
              internal_item_parent_id="113"
              trans_unit_id="113-2"
              internal_item_type="CodeSpan">
              <internal_items />
              <ItemValue>ROLLUP</ItemValue>
            </CodeSpanItem>
            <InternalNormalItem
              internal_item_id="3"
              internal_item_parent_id="113"
              trans_unit_id="113-3"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="32fefa21-1865-4c5d-ab3c-312dab1b747f"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="32fefa21-1865-4c5d-ab3c-312dab1b747f">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>SELECT [SalesTerritoryCountry]
,      [SalesTerritoryRegion]
,      SUM(SalesAmount)             AS TotalSalesAmount
FROM  dbo.factInternetSales s
JOIN  dbo.DimSalesTerritory t       ON s.SalesTerritoryKey       = t.SalesTerritoryKey
GROUP BY ROLLUP (
                        [SalesTerritoryCountry]
                ,       [SalesTerritoryRegion]
                )
;</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="2ebda9e5-93d4-4770-aa83-bc4c322de9a5"
        item_type="NormalParagraph"
        item_footer="footer_not_set"
        trans_unit_id="2ebda9e5-93d4-4770-aa83-bc4c322de9a5">
        <Lines>
          <MarkdownLine>
            <LineId>d1753276-d296-47dd-93a0-8acdf9f930ab</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="114">
                <SegmentId>dc13c106-dca2-4455-bab4-e0ce4acb6514</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="114"
                  trans_unit_id="114-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="114">
            <SegmentId>dc13c106-dca2-4455-bab4-e0ce4acb6514</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="114"
              trans_unit_id="114-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownListBlock"
        item_id="a3bbfcf9-c4bd-427a-9ede-ded86fbccd9c"
        item_type="List"
        item_footer=""
        trans_unit_id="a3bbfcf9-c4bd-427a-9ede-ded86fbccd9c">
        <inner_list_items>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="d46a1cc5-7a3f-4aaf-925c-c200aa3fd1b2"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="d46a1cc5-7a3f-4aaf-925c-c200aa3fd1b2">
              <Lines>
                <MarkdownLine>
                  <LineId>58eca16d-81a8-4fa1-98c2-016921bf5fb3</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="115">
                      <SegmentId>5f528c2c-c585-40c5-bdf1-84f539178be7</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="115"
                        trans_unit_id="115-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="115">
                  <SegmentId>5f528c2c-c585-40c5-bdf1-84f539178be7</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="115"
                    trans_unit_id="115-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="78edc57f-1bdc-4a10-8311-fb680a5c027f"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="78edc57f-1bdc-4a10-8311-fb680a5c027f">
              <Lines>
                <MarkdownLine>
                  <LineId>93d694cf-76b9-44ac-ba97-df653f1cc1ef</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="116">
                      <SegmentId>65330b03-f21a-4091-996e-e7e4fccc2903</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="116"
                        trans_unit_id="116-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="116">
                  <SegmentId>65330b03-f21a-4091-996e-e7e4fccc2903</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="116"
                    trans_unit_id="116-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="1d814058-409c-4f52-a850-ecdbb3919e7f"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="1d814058-409c-4f52-a850-ecdbb3919e7f">
              <Lines>
                <MarkdownLine>
                  <LineId>8cc287d7-fe3e-443f-aadf-4a0767b3d811</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="117">
                      <SegmentId>ddc13cca-464e-4387-897d-a7e5996855d7</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="117"
                        trans_unit_id="117-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="117">
                  <SegmentId>ddc13cca-464e-4387-897d-a7e5996855d7</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="117"
                    trans_unit_id="117-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
        </inner_list_items>
        <ListType>Charactor</ListType>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="df819f15-e5c4-46f5-bad8-970bb6968e43"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="df819f15-e5c4-46f5-bad8-970bb6968e43">
        <Lines>
          <MarkdownLine>
            <LineId>f1c47125-e2b7-40ff-acc1-4de7c85a2d80</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="118">
                <SegmentId>8b68ed59-9b87-4537-9333-da8be3fb7e28</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="118"
                  trans_unit_id="118-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
                <CodeSpanItem
                  internal_item_id="2"
                  internal_item_parent_id="118"
                  trans_unit_id="118-2"
                  internal_item_type="CodeSpan">
                  <internal_items />
                  <ItemValue>UNION ALL</ItemValue>
                </CodeSpanItem>
                <InternalNormalItem
                  internal_item_id="3"
                  internal_item_parent_id="118"
                  trans_unit_id="118-3"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="118">
            <SegmentId>8b68ed59-9b87-4537-9333-da8be3fb7e28</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="118"
              trans_unit_id="118-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
            <CodeSpanItem
              internal_item_id="2"
              internal_item_parent_id="118"
              trans_unit_id="118-2"
              internal_item_type="CodeSpan">
              <internal_items />
              <ItemValue>UNION ALL</ItemValue>
            </CodeSpanItem>
            <InternalNormalItem
              internal_item_id="3"
              internal_item_parent_id="118"
              trans_unit_id="118-3"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="f6582cb7-6511-4e03-982d-e89f734a4906"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="f6582cb7-6511-4e03-982d-e89f734a4906">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>SELECT [SalesTerritoryCountry]
,      [SalesTerritoryRegion]
,      SUM(SalesAmount) AS TotalSalesAmount
FROM  dbo.factInternetSales s
JOIN  dbo.DimSalesTerritory t     ON s.SalesTerritoryKey       = t.SalesTerritoryKey
GROUP BY 
       [SalesTerritoryCountry]
,      [SalesTerritoryRegion]
UNION ALL
SELECT [SalesTerritoryCountry]
,      NULL
,      SUM(SalesAmount) AS TotalSalesAmount
FROM  dbo.factInternetSales s
JOIN  dbo.DimSalesTerritory t     ON s.SalesTerritoryKey       = t.SalesTerritoryKey
GROUP BY 
       [SalesTerritoryCountry]
UNION ALL
SELECT NULL
,      NULL
,      SUM(SalesAmount) AS TotalSalesAmount
FROM  dbo.factInternetSales s
JOIN  dbo.DimSalesTerritory t     ON s.SalesTerritoryKey       = t.SalesTerritoryKey;</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="d4045641-c01d-4332-8592-80c883230387"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="d4045641-c01d-4332-8592-80c883230387">
        <Lines>
          <MarkdownLine>
            <LineId>a40ec84c-3e26-4544-937e-159784a7a802</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="119">
                <SegmentId>34626297-df98-4083-a778-4266e65de398</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="119"
                  trans_unit_id="119-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="119">
            <SegmentId>34626297-df98-4083-a778-4266e65de398</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="119"
              trans_unit_id="119-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="bc32aca0-898f-4878-b0c5-ad6fe5be9fd7"
        item_type="Header"
        item_footer="footer_not_set"
        trans_unit_id="bc32aca0-898f-4878-b0c5-ad6fe5be9fd7">
        <segment
          trans_unit_id="120">
          <SegmentId>c354183b-d645-4299-af4f-35258f5a98aa</SegmentId>
          <InternalNormalItem
            internal_item_id="1"
            internal_item_parent_id="120"
            trans_unit_id="120-1"
            internal_item_type="Normal">
            <internal_items />
          </InternalNormalItem>
        </segment>
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="0d888474-3e6d-46df-b3c6-7b1198917c80"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="0d888474-3e6d-46df-b3c6-7b1198917c80">
        <Lines>
          <MarkdownLine>
            <LineId>a0fb5391-515f-4afd-9dd0-0c5df89cdca4</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="121">
                <SegmentId>b3df8de7-33a7-48fc-9665-2183964d1ada</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="121"
                  trans_unit_id="121-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="122">
                <SegmentId>87fe23f9-362e-439a-a381-b0056d78c1fd</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="122"
                  trans_unit_id="122-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="123">
                <SegmentId>aebc89c7-3f2a-46bf-ad57-418aee354718</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="123"
                  trans_unit_id="123-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="121">
            <SegmentId>b3df8de7-33a7-48fc-9665-2183964d1ada</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="121"
              trans_unit_id="121-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="122">
            <SegmentId>87fe23f9-362e-439a-a381-b0056d78c1fd</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="122"
              trans_unit_id="122-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="123">
            <SegmentId>aebc89c7-3f2a-46bf-ad57-418aee354718</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="123"
              trans_unit_id="123-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="6457f7a3-462c-4686-9574-516849e43be0"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="6457f7a3-462c-4686-9574-516849e43be0">
        <Lines>
          <MarkdownLine>
            <LineId>eccacaf6-0e08-4dcc-bd7b-769334220f14</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="124">
                <SegmentId>69b7f93c-41a9-4c71-80a8-e08524f32ffe</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="124"
                  trans_unit_id="124-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="124">
            <SegmentId>69b7f93c-41a9-4c71-80a8-e08524f32ffe</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="124"
              trans_unit_id="124-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="1583bb61-8db4-4c1f-9b31-9c9751191619"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="1583bb61-8db4-4c1f-9b31-9c9751191619">
        <Lines>
          <MarkdownLine>
            <LineId>53ec34ec-b1b9-48e0-bb4d-7e15d4a474f1</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="125">
                <SegmentId>0cb93b42-0041-400a-b842-0477519199aa</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="125"
                  trans_unit_id="125-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="126">
                <SegmentId>281b097f-081f-4da0-9459-6fc1f084cc17</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="126"
                  trans_unit_id="126-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="127">
                <SegmentId>4968877c-25e8-4c32-a6de-0209523cff2f</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="127"
                  trans_unit_id="127-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="128">
                <SegmentId>b1b0c8cb-3729-4b65-a6d3-318eab8f2e45</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="128"
                  trans_unit_id="128-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="125">
            <SegmentId>0cb93b42-0041-400a-b842-0477519199aa</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="125"
              trans_unit_id="125-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="126">
            <SegmentId>281b097f-081f-4da0-9459-6fc1f084cc17</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="126"
              trans_unit_id="126-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="127">
            <SegmentId>4968877c-25e8-4c32-a6de-0209523cff2f</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="127"
              trans_unit_id="127-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="128">
            <SegmentId>b1b0c8cb-3729-4b65-a6d3-318eab8f2e45</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="128"
              trans_unit_id="128-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="4c1e7ecb-10df-44aa-a3ea-1beed7523dc6"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="4c1e7ecb-10df-44aa-a3ea-1beed7523dc6">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>CREATE TABLE #Cube
WITH 
(   DISTRIBUTION = ROUND_ROBIN
,   LOCATION = USER_DB
)
AS
WITH GrpCube AS
(SELECT    CAST(ISNULL(Country,'NULL')+','+ISNULL(Region,'NULL') AS NVARCHAR(50)) as 'Cols'
,          CAST(ISNULL(Country+',','')+ISNULL(Region,'') AS NVARCHAR(50))  as 'GroupBy'
,          ROW_NUMBER() OVER (ORDER BY Country) as 'Seq'
FROM       ( SELECT 'SalesTerritoryCountry' as Country
             UNION ALL
             SELECT NULL
           ) c
CROSS JOIN ( SELECT 'SalesTerritoryRegion' as Region
             UNION ALL
             SELECT NULL
           ) r
)
SELECT Cols
,      CASE WHEN SUBSTRING(GroupBy,LEN(GroupBy),1) = ',' 
            THEN SUBSTRING(GroupBy,1,LEN(GroupBy)-1) 
            ELSE GroupBy 
       END AS GroupBy  --Remove Trailing Comma
,Seq
FROM GrpCube;</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="d10350a7-d2ee-4503-bdcc-60f9406bdfbb"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="d10350a7-d2ee-4503-bdcc-60f9406bdfbb">
        <Lines>
          <MarkdownLine>
            <LineId>c71a2e17-4c57-42f5-a345-77703b38a82e</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="129">
                <SegmentId>a8d0541c-eca2-4df1-a9ed-696b2ba43c26</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="129"
                  trans_unit_id="129-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="129">
            <SegmentId>a8d0541c-eca2-4df1-a9ed-696b2ba43c26</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="129"
              trans_unit_id="129-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="a607d6a1-3e4e-418d-ab5b-e30054edb822"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="a607d6a1-3e4e-418d-ab5b-e30054edb822">
        <Lines>
          <MarkdownLine>
            <LineId>432b4631-f871-4402-a059-fcd0dcdfca92</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="130">
                <SegmentId>0c535d3c-35aa-494d-a4d5-e62ef653a6cd</SegmentId>
                <ImageItem
                  internal_item_id="1"
                  internal_item_parent_id="130"
                  trans_unit_id="130-1"
                  internal_item_type="Image">
                  <internal_items />
                  <internal_Image_type>Reference</internal_Image_type>
                  <internal_link_text />
                  <internal_link_id>1</internal_link_id>
                </ImageItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="130">
            <SegmentId>0c535d3c-35aa-494d-a4d5-e62ef653a6cd</SegmentId>
            <ImageItem
              internal_item_id="1"
              internal_item_parent_id="130"
              trans_unit_id="130-1"
              internal_item_type="Image">
              <internal_items />
              <internal_Image_type>Reference</internal_Image_type>
              <internal_link_text />
              <internal_link_id>1</internal_link_id>
            </ImageItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="921058da-b54d-4364-bd49-f8878cf7daab"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="921058da-b54d-4364-bd49-f8878cf7daab">
        <Lines>
          <MarkdownLine>
            <LineId>b44b6206-0fe7-463e-ade4-b09ac0b4a9ff</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="131">
                <SegmentId>df19bfed-c651-4702-a630-03d6f29522bd</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="131"
                  trans_unit_id="131-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="131">
            <SegmentId>df19bfed-c651-4702-a630-03d6f29522bd</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="131"
              trans_unit_id="131-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="e547ca5f-3631-4b41-8a5c-1d0aba316e95"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="e547ca5f-3631-4b41-8a5c-1d0aba316e95">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block> @SQL NVARCHAR(4000)
,@Columns NVARCHAR(4000)
,@GroupBy NVARCHAR(4000)
,@i INT = 1
,@nbr INT = 0
;
CREATE TABLE #Results
(
 [SalesTerritoryCountry] NVARCHAR(50)
,[SalesTerritoryRegion]  NVARCHAR(50)
,[TotalSalesAmount]      MONEY
)
WITH
(   DISTRIBUTION = ROUND_ROBIN
,   LOCATION = USER_DB
)
;</code_block>
        <fenced_code_lang>
DECLARE </fenced_code_lang>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="af16b661-2979-4b85-aa6a-a71141893831"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="af16b661-2979-4b85-aa6a-a71141893831">
        <Lines>
          <MarkdownLine>
            <LineId>48b9a396-8d83-4bde-bee5-4e9148e773d3</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="132">
                <SegmentId>db119555-a1fb-4a46-b51f-a9ae7dbeb7cc</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="132"
                  trans_unit_id="132-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="133">
                <SegmentId>9d74e7a9-b7fc-4ee6-908c-4b01faf39f0d</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="133"
                  trans_unit_id="133-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="132">
            <SegmentId>db119555-a1fb-4a46-b51f-a9ae7dbeb7cc</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="132"
              trans_unit_id="132-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="133">
            <SegmentId>9d74e7a9-b7fc-4ee6-908c-4b01faf39f0d</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="133"
              trans_unit_id="133-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="87942872-a4f5-4d46-b3b3-1e25610786c7"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="87942872-a4f5-4d46-b3b3-1e25610786c7">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>SET @nbr =(SELECT MAX(Seq) FROM #Cube);

WHILE @i&lt;=@nbr
BEGIN
    SET @Columns = (SELECT Cols    FROM #Cube where seq = @i);
    SET @GroupBy = (SELECT GroupBy FROM #Cube where seq = @i);

    SET @SQL ='INSERT INTO #Results
              SELECT '+@Columns+'
              ,      SUM(SalesAmount) AS TotalSalesAmount
              FROM  dbo.factInternetSales s
              JOIN  dbo.DimSalesTerritory t  
              ON s.SalesTerritoryKey = t.SalesTerritoryKey
              '+CASE WHEN @GroupBy &lt;&gt;'' 
                     THEN 'GROUP BY '+@GroupBy ELSE '' END

    EXEC sp_executesql @SQL;
    SET @i +=1;
END</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="7dbddd93-52c3-4bfc-b5ba-f25a8cfeaded"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="7dbddd93-52c3-4bfc-b5ba-f25a8cfeaded">
        <Lines>
          <MarkdownLine>
            <LineId>034fdd3a-2707-46bb-8909-1aa92857575b</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="134">
                <SegmentId>18b0f385-4029-4ea0-ab7b-5f53b1c60b26</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="134"
                  trans_unit_id="134-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="134">
            <SegmentId>18b0f385-4029-4ea0-ab7b-5f53b1c60b26</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="134"
              trans_unit_id="134-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="3ed017d1-1cf4-4d9d-98bc-482076e3616d"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="3ed017d1-1cf4-4d9d-98bc-482076e3616d">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>SELECT * 
FROM #Results
ORDER BY 1,2,3
;</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="a3766a86-10b6-4aed-9184-6ff34a263db3"
        item_type="NormalParagraph"
        item_footer="&#xA;"
        trans_unit_id="a3766a86-10b6-4aed-9184-6ff34a263db3">
        <Lines>
          <MarkdownLine>
            <LineId>50a9b887-fc6a-4ddd-991e-a6a3c0243888</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="135">
                <SegmentId>dd8ec4bf-8885-4ffb-94c9-d2df40c4c5c9</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="135"
                  trans_unit_id="135-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="135">
            <SegmentId>dd8ec4bf-8885-4ffb-94c9-d2df40c4c5c9</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="135"
              trans_unit_id="135-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="fc2c64e2-a979-485e-b1da-7dc98b37304d"
        item_type="Header"
        item_footer="footer_not_set"
        trans_unit_id="fc2c64e2-a979-485e-b1da-7dc98b37304d">
        <segment
          trans_unit_id="136">
          <SegmentId>4127eb7e-e813-4e77-9eb2-5688e5d72204</SegmentId>
          <InternalNormalItem
            internal_item_id="1"
            internal_item_parent_id="136"
            trans_unit_id="136-1"
            internal_item_type="Normal">
            <internal_items />
          </InternalNormalItem>
        </segment>
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="1aa951af-2f55-46b5-a99b-775830bd8e88"
        item_type="NormalParagraph"
        item_footer="&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;"
        trans_unit_id="1aa951af-2f55-46b5-a99b-775830bd8e88">
        <Lines>
          <MarkdownLine>
            <LineId>4d709a49-09ac-4b60-94ac-ebaff503e8a0</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="137">
                <SegmentId>87eda501-b52a-4d77-91bc-57241fd9b3c1</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="137"
                  trans_unit_id="137-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
                <LinkItem
                  internal_item_id="2"
                  internal_item_parent_id="137"
                  trans_unit_id="137-2"
                  internal_item_type="Link">
                  <internal_items />
                  <internal_link_type>Reference</internal_link_type>
                  <internal_link_text>development overview</internal_link_text>
                  <internal_link_id />
                </LinkItem>
                <InternalNormalItem
                  internal_item_id="3"
                  internal_item_parent_id="137"
                  trans_unit_id="137-3"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="137">
            <SegmentId>87eda501-b52a-4d77-91bc-57241fd9b3c1</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="137"
              trans_unit_id="137-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
            <LinkItem
              internal_item_id="2"
              internal_item_parent_id="137"
              trans_unit_id="137-2"
              internal_item_type="Link">
              <internal_items />
              <internal_link_type>Reference</internal_link_type>
              <internal_link_text>development overview</internal_link_text>
              <internal_link_id />
            </LinkItem>
            <InternalNormalItem
              internal_item_id="3"
              internal_item_parent_id="137"
              trans_unit_id="137-3"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
    </ArrayOfMarkdownBlockBase>
  </block_element>
  <references>
    <ArrayOfMarkdownLinkedReference xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <MarkdownLinkedReference
        item_id="5e48003b-7a27-4b83-ae1e-f2c259ebb3d7"
        item_type="LinkedReference"
        item_footer="footer_not_set"
        trans_unit_id="5e48003b-7a27-4b83-ae1e-f2c259ebb3d7">
        <link_id>1</link_id>
        <link_uri>media/sql-data-warehouse-develop-group-by-options/sql-data-warehouse-develop-group-by-cube.png</link_uri>
        <link_title />
      </MarkdownLinkedReference>
      <MarkdownLinkedReference
        item_id="05a6411d-458b-4604-8460-6d4d226003fb"
        item_type="LinkedReference"
        item_footer="footer_not_set"
        trans_unit_id="05a6411d-458b-4604-8460-6d4d226003fb">
        <link_id>development overview</link_id>
        <link_uri>sql-data-warehouse-overview-develop.md</link_uri>
        <link_title />
      </MarkdownLinkedReference>
      <MarkdownLinkedReference
        item_id="22c9bf39-23c9-4c33-b5fe-a4c1566db8c4"
        item_type="LinkedReference"
        item_footer="footer_not_set"
        trans_unit_id="22c9bf39-23c9-4c33-b5fe-a4c1566db8c4">
        <link_id>group by</link_id>
        <link_uri>https://msdn.microsoft.com/en-us/library/ms177673.aspx</link_uri>
        <link_title />
      </MarkdownLinkedReference>
    </ArrayOfMarkdownLinkedReference>
  </references>
</markdown_skeleton_root>