<markdown_skeleton_root>
  <block_element>
    <ArrayOfMarkdownBlockBase xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <MarkdownBlockBase
        xsi:type="MarkdownAzureMetadataBlock"
        item_id="053bf446-6334-4974-8538-a8ef30ce833e"
        item_type="AzureMetadata"
        item_footer="footer_not_set"
        trans_unit_id="053bf446-6334-4974-8538-a8ef30ce833e">
        <LocalizeItemList>
          <MarkdownInternalXmlItem
            internal_item_id="b336d054-1968-42cc-8282-228af2945441"
            trans_unit_id="101"
            internal_item_type="Xml">
            <internal_items />
          </MarkdownInternalXmlItem>
          <MarkdownInternalXmlItem
            internal_item_id="762d8081-7f96-4f43-86b1-c861a744307e"
            trans_unit_id="102"
            internal_item_type="Xml">
            <internal_items />
          </MarkdownInternalXmlItem>
        </LocalizeItemList>
        <ItemValue>&lt;properties
   pageTitle="b336d054-1968-42cc-8282-228af2945441"
   description="762d8081-7f96-4f43-86b1-c861a744307e"
   services="sql-data-warehouse"
   documentationCenter="NA"
   authors="jrowlandjones"
   manager="barbkess"
   editor=""/&gt;

&lt;tags
   ms.service="sql-data-warehouse"
   ms.devlang="NA"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="data-services"
   ms.date="06/26/2015"
   ms.author="JRJ@BigBangData.co.uk;barbkess"/&gt;

</ItemValue>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="783e0cd0-ed52-4da1-a75a-bd3e44d2b9c2"
        item_type="Header"
        item_footer="footer_not_set"
        trans_unit_id="783e0cd0-ed52-4da1-a75a-bd3e44d2b9c2">
        <segment
          trans_unit_id="103">
          <SegmentId>ae0d2cd6-4764-4076-a105-c1da171d386b</SegmentId>
          <InternalNormalItem
            internal_item_id="1"
            internal_item_parent_id="103"
            trans_unit_id="103-1"
            internal_item_type="Normal">
            <internal_items />
          </InternalNormalItem>
        </segment>
        <header_type>Star</header_type>
        <header_level>1</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="fa1a5dba-e5dd-4815-bff0-450a2ee1a180"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="fa1a5dba-e5dd-4815-bff0-450a2ee1a180">
        <Lines>
          <MarkdownLine>
            <LineId>699db542-bc36-4691-bc2f-7cbf9d5cb50d</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="104">
                <SegmentId>070275e5-d0f8-4824-a353-a3276ec2dfa0</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="104"
                  trans_unit_id="104-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="105">
                <SegmentId>b7fae3a5-a5d4-49af-ab9a-5b846e7a5a05</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="105"
                  trans_unit_id="105-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="104">
            <SegmentId>070275e5-d0f8-4824-a353-a3276ec2dfa0</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="104"
              trans_unit_id="104-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="105">
            <SegmentId>b7fae3a5-a5d4-49af-ab9a-5b846e7a5a05</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="105"
              trans_unit_id="105-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="da1382cc-9faa-43ed-a2cc-18bfa2b0c2cb"
        item_type="NormalParagraph"
        item_footer="footer_not_set"
        trans_unit_id="da1382cc-9faa-43ed-a2cc-18bfa2b0c2cb">
        <Lines>
          <MarkdownLine>
            <LineId>ec4a761c-a5c5-4193-b050-3ab49b816948</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="106">
                <SegmentId>af66a33e-2738-4406-bfdf-6032a6160edd</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="106"
                  trans_unit_id="106-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="106">
            <SegmentId>af66a33e-2738-4406-bfdf-6032a6160edd</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="106"
              trans_unit_id="106-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownListBlock"
        item_id="65cf865c-020f-4cb2-9cd3-76c7735bf8a2"
        item_type="List"
        item_footer=""
        trans_unit_id="65cf865c-020f-4cb2-9cd3-76c7735bf8a2">
        <inner_list_items>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="8891d8de-39c2-4652-857d-a6f39b5f5d59"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="8891d8de-39c2-4652-857d-a6f39b5f5d59">
              <Lines>
                <MarkdownLine>
                  <LineId>8d84733d-5bcf-499d-bd74-40d4c743e7fa</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="107">
                      <SegmentId>aa040f0b-ab58-4d05-a8a4-18cf2e29e23f</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="107"
                        trans_unit_id="107-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="107">
                  <SegmentId>aa040f0b-ab58-4d05-a8a4-18cf2e29e23f</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="107"
                    trans_unit_id="107-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="3ee86cdf-aed9-43e2-afbc-593c04a72fe4"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="3ee86cdf-aed9-43e2-afbc-593c04a72fe4">
              <Lines>
                <MarkdownLine>
                  <LineId>044730b1-11fb-43b9-9b55-4f836956b59c</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="108">
                      <SegmentId>21537c38-473b-45ff-986d-649b7e130260</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="108"
                        trans_unit_id="108-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="108">
                  <SegmentId>21537c38-473b-45ff-986d-649b7e130260</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="108"
                    trans_unit_id="108-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="f072f4c4-dbe9-43dc-8d85-7fe2fb3c47f6"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="f072f4c4-dbe9-43dc-8d85-7fe2fb3c47f6">
              <Lines>
                <MarkdownLine>
                  <LineId>5994324a-9839-4430-bd2b-d68b8bf4d001</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="109">
                      <SegmentId>f544f1cf-e308-4d04-9a03-553ebf319ffd</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="109"
                        trans_unit_id="109-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="109">
                  <SegmentId>f544f1cf-e308-4d04-9a03-553ebf319ffd</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="109"
                    trans_unit_id="109-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
        </inner_list_items>
        <ListType>Charactor</ListType>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="92facef3-a6c8-474b-ae12-dda704057cf3"
        item_type="Header"
        item_footer="footer_not_set"
        trans_unit_id="92facef3-a6c8-474b-ae12-dda704057cf3">
        <segment
          trans_unit_id="110">
          <SegmentId>83daa951-18dc-473f-975c-f9d004debe21</SegmentId>
          <InternalNormalItem
            internal_item_id="1"
            internal_item_parent_id="110"
            trans_unit_id="110-1"
            internal_item_type="Normal">
            <internal_items />
          </InternalNormalItem>
        </segment>
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="e4959106-e7a5-4773-a6d0-fb61eb8c4136"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="e4959106-e7a5-4773-a6d0-fb61eb8c4136">
        <Lines>
          <MarkdownLine>
            <LineId>6e014029-e6d1-440f-9729-4d24f4cf9606</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="111">
                <SegmentId>c1020632-e1b6-4b9f-97ff-3dda24512402</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="111"
                  trans_unit_id="111-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
                <CodeSpanItem
                  internal_item_id="2"
                  internal_item_parent_id="111"
                  trans_unit_id="111-2"
                  internal_item_type="CodeSpan">
                  <internal_items />
                  <ItemValue>UNION ALL</ItemValue>
                </CodeSpanItem>
                <InternalNormalItem
                  internal_item_id="3"
                  internal_item_parent_id="111"
                  trans_unit_id="111-3"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="112">
                <SegmentId>d460ce11-28b5-4c3f-9c71-1a365bbd3674</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="112"
                  trans_unit_id="112-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="111">
            <SegmentId>c1020632-e1b6-4b9f-97ff-3dda24512402</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="111"
              trans_unit_id="111-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
            <CodeSpanItem
              internal_item_id="2"
              internal_item_parent_id="111"
              trans_unit_id="111-2"
              internal_item_type="CodeSpan">
              <internal_items />
              <ItemValue>UNION ALL</ItemValue>
            </CodeSpanItem>
            <InternalNormalItem
              internal_item_id="3"
              internal_item_parent_id="111"
              trans_unit_id="111-3"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="112">
            <SegmentId>d460ce11-28b5-4c3f-9c71-1a365bbd3674</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="112"
              trans_unit_id="112-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="304e2419-5068-4495-9c57-defbf1710d0d"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="304e2419-5068-4495-9c57-defbf1710d0d">
        <Lines>
          <MarkdownLine>
            <LineId>f8a50255-f0c6-4c58-9fb7-92a69a7d27a9</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="113">
                <SegmentId>d2bb30e2-c365-4629-9e67-2b1dd1c241c3</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="113"
                  trans_unit_id="113-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
                <CodeSpanItem
                  internal_item_id="2"
                  internal_item_parent_id="113"
                  trans_unit_id="113-2"
                  internal_item_type="CodeSpan">
                  <internal_items />
                  <ItemValue>ROLLUP</ItemValue>
                </CodeSpanItem>
                <InternalNormalItem
                  internal_item_id="3"
                  internal_item_parent_id="113"
                  trans_unit_id="113-3"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="113">
            <SegmentId>d2bb30e2-c365-4629-9e67-2b1dd1c241c3</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="113"
              trans_unit_id="113-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
            <CodeSpanItem
              internal_item_id="2"
              internal_item_parent_id="113"
              trans_unit_id="113-2"
              internal_item_type="CodeSpan">
              <internal_items />
              <ItemValue>ROLLUP</ItemValue>
            </CodeSpanItem>
            <InternalNormalItem
              internal_item_id="3"
              internal_item_parent_id="113"
              trans_unit_id="113-3"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="ede725cc-cd85-4bba-8269-c69a25a4d6de"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="ede725cc-cd85-4bba-8269-c69a25a4d6de">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>SELECT [SalesTerritoryCountry]
,      [SalesTerritoryRegion]
,      SUM(SalesAmount)             AS TotalSalesAmount
FROM  dbo.factInternetSales s
JOIN  dbo.DimSalesTerritory t       ON s.SalesTerritoryKey       = t.SalesTerritoryKey
GROUP BY ROLLUP (
                        [SalesTerritoryCountry]
                ,       [SalesTerritoryRegion]
                )
;</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="431d5b64-484f-48ee-8f3a-855def5881a4"
        item_type="NormalParagraph"
        item_footer="footer_not_set"
        trans_unit_id="431d5b64-484f-48ee-8f3a-855def5881a4">
        <Lines>
          <MarkdownLine>
            <LineId>3e3d2a1f-e6d0-424a-8282-2480e58a29d3</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="114">
                <SegmentId>15763c36-a6e0-4eeb-acfb-8587900220dd</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="114"
                  trans_unit_id="114-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="114">
            <SegmentId>15763c36-a6e0-4eeb-acfb-8587900220dd</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="114"
              trans_unit_id="114-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownListBlock"
        item_id="94dc1e9d-6cc2-4ba0-89dc-a789434afc2e"
        item_type="List"
        item_footer=""
        trans_unit_id="94dc1e9d-6cc2-4ba0-89dc-a789434afc2e">
        <inner_list_items>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="8094d223-6544-4116-97e8-dc20d65b23bd"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="8094d223-6544-4116-97e8-dc20d65b23bd">
              <Lines>
                <MarkdownLine>
                  <LineId>84bc215b-4fe1-4a9f-94e7-168edfdc4c45</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="115">
                      <SegmentId>dd397934-3657-4c3a-860d-a4fea4020d5f</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="115"
                        trans_unit_id="115-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="115">
                  <SegmentId>dd397934-3657-4c3a-860d-a4fea4020d5f</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="115"
                    trans_unit_id="115-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="27729b4c-0f06-40d3-b4b4-76864cdffcad"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="27729b4c-0f06-40d3-b4b4-76864cdffcad">
              <Lines>
                <MarkdownLine>
                  <LineId>584c166a-b71b-47db-ae39-0b009c852eb0</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="116">
                      <SegmentId>267372fe-7dab-4e5c-8046-310154b5e8f3</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="116"
                        trans_unit_id="116-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="116">
                  <SegmentId>267372fe-7dab-4e5c-8046-310154b5e8f3</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="116"
                    trans_unit_id="116-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="bcefa0e4-a427-48ad-8388-ac7247d147a0"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="bcefa0e4-a427-48ad-8388-ac7247d147a0">
              <Lines>
                <MarkdownLine>
                  <LineId>9772df90-f831-470d-a8f2-af46e264de34</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="117">
                      <SegmentId>3758b25f-8bc7-4343-aa77-44efde2d31e2</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="117"
                        trans_unit_id="117-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="117">
                  <SegmentId>3758b25f-8bc7-4343-aa77-44efde2d31e2</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="117"
                    trans_unit_id="117-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
        </inner_list_items>
        <ListType>Charactor</ListType>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="81a7a9a8-e88b-4610-bfe2-8edf9df2766a"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="81a7a9a8-e88b-4610-bfe2-8edf9df2766a">
        <Lines>
          <MarkdownLine>
            <LineId>64d273f1-5d53-4db0-9ce6-755923f2417e</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="118">
                <SegmentId>00fdf9d8-8f66-4d42-babe-8f2d38701620</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="118"
                  trans_unit_id="118-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
                <CodeSpanItem
                  internal_item_id="2"
                  internal_item_parent_id="118"
                  trans_unit_id="118-2"
                  internal_item_type="CodeSpan">
                  <internal_items />
                  <ItemValue>UNION ALL</ItemValue>
                </CodeSpanItem>
                <InternalNormalItem
                  internal_item_id="3"
                  internal_item_parent_id="118"
                  trans_unit_id="118-3"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="118">
            <SegmentId>00fdf9d8-8f66-4d42-babe-8f2d38701620</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="118"
              trans_unit_id="118-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
            <CodeSpanItem
              internal_item_id="2"
              internal_item_parent_id="118"
              trans_unit_id="118-2"
              internal_item_type="CodeSpan">
              <internal_items />
              <ItemValue>UNION ALL</ItemValue>
            </CodeSpanItem>
            <InternalNormalItem
              internal_item_id="3"
              internal_item_parent_id="118"
              trans_unit_id="118-3"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="9405d6d5-e4ad-4c57-9a64-bec8f9225cf2"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="9405d6d5-e4ad-4c57-9a64-bec8f9225cf2">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>SELECT [SalesTerritoryCountry]
,      [SalesTerritoryRegion]
,      SUM(SalesAmount) AS TotalSalesAmount
FROM  dbo.factInternetSales s
JOIN  dbo.DimSalesTerritory t     ON s.SalesTerritoryKey       = t.SalesTerritoryKey
GROUP BY 
       [SalesTerritoryCountry]
,      [SalesTerritoryRegion]
UNION ALL
SELECT [SalesTerritoryCountry]
,      NULL
,      SUM(SalesAmount) AS TotalSalesAmount
FROM  dbo.factInternetSales s
JOIN  dbo.DimSalesTerritory t     ON s.SalesTerritoryKey       = t.SalesTerritoryKey
GROUP BY 
       [SalesTerritoryCountry]
UNION ALL
SELECT NULL
,      NULL
,      SUM(SalesAmount) AS TotalSalesAmount
FROM  dbo.factInternetSales s
JOIN  dbo.DimSalesTerritory t     ON s.SalesTerritoryKey       = t.SalesTerritoryKey;</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="0eb04dc2-3f70-4b37-9959-82542e4cdf6a"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="0eb04dc2-3f70-4b37-9959-82542e4cdf6a">
        <Lines>
          <MarkdownLine>
            <LineId>fc8b5288-2c2d-4e1d-af8d-0ba45ac1371b</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="119">
                <SegmentId>1795887c-5e75-404d-8815-3e744f6a6a2e</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="119"
                  trans_unit_id="119-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="119">
            <SegmentId>1795887c-5e75-404d-8815-3e744f6a6a2e</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="119"
              trans_unit_id="119-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="ec1a8912-8cf0-4be0-a088-d357b72afddf"
        item_type="Header"
        item_footer="footer_not_set"
        trans_unit_id="ec1a8912-8cf0-4be0-a088-d357b72afddf">
        <segment
          trans_unit_id="120">
          <SegmentId>395f302e-2847-494d-9f8f-85a751378a0a</SegmentId>
          <InternalNormalItem
            internal_item_id="1"
            internal_item_parent_id="120"
            trans_unit_id="120-1"
            internal_item_type="Normal">
            <internal_items />
          </InternalNormalItem>
        </segment>
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="2e935ff7-0d7f-43da-a027-044b2ee55e07"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="2e935ff7-0d7f-43da-a027-044b2ee55e07">
        <Lines>
          <MarkdownLine>
            <LineId>1e27136a-d343-4b97-a60a-65aca8c82b91</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="121">
                <SegmentId>9859b205-5b68-4775-9ed7-972957b81e0c</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="121"
                  trans_unit_id="121-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="122">
                <SegmentId>9ae8e790-17b1-4846-aa32-f2acd3d16c77</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="122"
                  trans_unit_id="122-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="123">
                <SegmentId>157d0165-19c3-432a-871c-bf73fc41a72f</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="123"
                  trans_unit_id="123-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="121">
            <SegmentId>9859b205-5b68-4775-9ed7-972957b81e0c</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="121"
              trans_unit_id="121-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="122">
            <SegmentId>9ae8e790-17b1-4846-aa32-f2acd3d16c77</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="122"
              trans_unit_id="122-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="123">
            <SegmentId>157d0165-19c3-432a-871c-bf73fc41a72f</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="123"
              trans_unit_id="123-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="25e9a5ab-bfa6-47e8-a1b8-19dfe08f9e04"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="25e9a5ab-bfa6-47e8-a1b8-19dfe08f9e04">
        <Lines>
          <MarkdownLine>
            <LineId>48698f59-7a8d-4677-9f49-8f8def02c46c</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="124">
                <SegmentId>9ffb6d0a-6090-4195-a309-6b0899902479</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="124"
                  trans_unit_id="124-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="124">
            <SegmentId>9ffb6d0a-6090-4195-a309-6b0899902479</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="124"
              trans_unit_id="124-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="5ae8a958-ba9e-429a-b7eb-eac0973de663"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="5ae8a958-ba9e-429a-b7eb-eac0973de663">
        <Lines>
          <MarkdownLine>
            <LineId>371cb5c1-1b39-46e1-a749-d8c2c4752e9b</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="125">
                <SegmentId>1d4f4e38-5cfd-4aa3-bee8-005a86e7da44</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="125"
                  trans_unit_id="125-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="126">
                <SegmentId>d8d95bb9-cee9-479a-abd1-265e341d5ecb</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="126"
                  trans_unit_id="126-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="127">
                <SegmentId>6080eba5-5ff9-42a0-85e6-1400a98316f9</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="127"
                  trans_unit_id="127-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="128">
                <SegmentId>c03efad3-4fe9-423e-97c6-96586441652d</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="128"
                  trans_unit_id="128-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="125">
            <SegmentId>1d4f4e38-5cfd-4aa3-bee8-005a86e7da44</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="125"
              trans_unit_id="125-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="126">
            <SegmentId>d8d95bb9-cee9-479a-abd1-265e341d5ecb</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="126"
              trans_unit_id="126-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="127">
            <SegmentId>6080eba5-5ff9-42a0-85e6-1400a98316f9</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="127"
              trans_unit_id="127-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="128">
            <SegmentId>c03efad3-4fe9-423e-97c6-96586441652d</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="128"
              trans_unit_id="128-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="a90dede5-3fce-45b4-b34c-88da2e0a099b"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="a90dede5-3fce-45b4-b34c-88da2e0a099b">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>CREATE TABLE #Cube
WITH 
(   DISTRIBUTION = ROUND_ROBIN
,   LOCATION = USER_DB
)
AS
WITH GrpCube AS
(SELECT    CAST(ISNULL(Country,'NULL')+','+ISNULL(Region,'NULL') AS NVARCHAR(50)) as 'Cols'
,          CAST(ISNULL(Country+',','')+ISNULL(Region,'') AS NVARCHAR(50))  as 'GroupBy'
,          ROW_NUMBER() OVER (ORDER BY Country) as 'Seq'
FROM       ( SELECT 'SalesTerritoryCountry' as Country
             UNION ALL
             SELECT NULL
           ) c
CROSS JOIN ( SELECT 'SalesTerritoryRegion' as Region
             UNION ALL
             SELECT NULL
           ) r
)
SELECT Cols
,      CASE WHEN SUBSTRING(GroupBy,LEN(GroupBy),1) = ',' 
            THEN SUBSTRING(GroupBy,1,LEN(GroupBy)-1) 
            ELSE GroupBy 
       END AS GroupBy  --Remove Trailing Comma
,Seq
FROM GrpCube;</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="54cd57cd-f343-4eae-b662-9a38068ae044"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="54cd57cd-f343-4eae-b662-9a38068ae044">
        <Lines>
          <MarkdownLine>
            <LineId>0f449d81-42a5-45ed-8a58-a0378837250e</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="129">
                <SegmentId>2b954dbf-64c3-46fb-8963-a95fb49d5a69</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="129"
                  trans_unit_id="129-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="129">
            <SegmentId>2b954dbf-64c3-46fb-8963-a95fb49d5a69</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="129"
              trans_unit_id="129-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="afc9b663-c721-4f0c-a8c2-b6980e8293bb"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="afc9b663-c721-4f0c-a8c2-b6980e8293bb">
        <Lines>
          <MarkdownLine>
            <LineId>856a42dd-c992-4e86-809c-9aabbf47cd3c</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="130">
                <SegmentId>e59be6b1-20d6-4d51-818b-10c5bd89bd01</SegmentId>
                <ImageItem
                  internal_item_id="1"
                  internal_item_parent_id="130"
                  trans_unit_id="130-1"
                  internal_item_type="Image">
                  <internal_items />
                  <internal_Image_type>Reference</internal_Image_type>
                  <internal_link_text />
                  <internal_link_id>1</internal_link_id>
                </ImageItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="130">
            <SegmentId>e59be6b1-20d6-4d51-818b-10c5bd89bd01</SegmentId>
            <ImageItem
              internal_item_id="1"
              internal_item_parent_id="130"
              trans_unit_id="130-1"
              internal_item_type="Image">
              <internal_items />
              <internal_Image_type>Reference</internal_Image_type>
              <internal_link_text />
              <internal_link_id>1</internal_link_id>
            </ImageItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="dcd98bba-16e8-4404-87db-b375fba0bc54"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="dcd98bba-16e8-4404-87db-b375fba0bc54">
        <Lines>
          <MarkdownLine>
            <LineId>2d31d4af-d179-4b71-8757-b4d441345601</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="131">
                <SegmentId>35343b57-a305-4acc-8021-fadaa4d4911b</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="131"
                  trans_unit_id="131-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="131">
            <SegmentId>35343b57-a305-4acc-8021-fadaa4d4911b</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="131"
              trans_unit_id="131-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="0a6dc8d0-94df-4985-b18f-a07eb4b21b78"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="0a6dc8d0-94df-4985-b18f-a07eb4b21b78">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block> @SQL NVARCHAR(4000)
,@Columns NVARCHAR(4000)
,@GroupBy NVARCHAR(4000)
,@i INT = 1
,@nbr INT = 0
;
CREATE TABLE #Results
(
 [SalesTerritoryCountry] NVARCHAR(50)
,[SalesTerritoryRegion]  NVARCHAR(50)
,[TotalSalesAmount]      MONEY
)
WITH
(   DISTRIBUTION = ROUND_ROBIN
,   LOCATION = USER_DB
)
;</code_block>
        <fenced_code_lang>
DECLARE </fenced_code_lang>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="ee0a4329-cebb-476f-9060-b7069e467ac7"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="ee0a4329-cebb-476f-9060-b7069e467ac7">
        <Lines>
          <MarkdownLine>
            <LineId>440ac844-4036-450b-8581-c4a1026c5a1b</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="132">
                <SegmentId>2b7ddf44-186c-4294-ae3b-4ac5639b0380</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="132"
                  trans_unit_id="132-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="133">
                <SegmentId>fbf6ce5e-1490-457e-a846-12a635aec8e7</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="133"
                  trans_unit_id="133-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="132">
            <SegmentId>2b7ddf44-186c-4294-ae3b-4ac5639b0380</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="132"
              trans_unit_id="132-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="133">
            <SegmentId>fbf6ce5e-1490-457e-a846-12a635aec8e7</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="133"
              trans_unit_id="133-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="3d315f4f-0dc6-4d21-9b30-4b5bc4175974"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="3d315f4f-0dc6-4d21-9b30-4b5bc4175974">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>SET @nbr =(SELECT MAX(Seq) FROM #Cube);

WHILE @i&lt;=@nbr
BEGIN
    SET @Columns = (SELECT Cols    FROM #Cube where seq = @i);
    SET @GroupBy = (SELECT GroupBy FROM #Cube where seq = @i);

    SET @SQL ='INSERT INTO #Results
              SELECT '+@Columns+'
              ,      SUM(SalesAmount) AS TotalSalesAmount
              FROM  dbo.factInternetSales s
              JOIN  dbo.DimSalesTerritory t  
              ON s.SalesTerritoryKey = t.SalesTerritoryKey
              '+CASE WHEN @GroupBy &lt;&gt;'' 
                     THEN 'GROUP BY '+@GroupBy ELSE '' END

    EXEC sp_executesql @SQL;
    SET @i +=1;
END</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="4dc0c40a-7947-48bd-a133-d2877122843b"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="4dc0c40a-7947-48bd-a133-d2877122843b">
        <Lines>
          <MarkdownLine>
            <LineId>b576b82c-4703-4ad5-8aef-f286c95b7aeb</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="134">
                <SegmentId>21acdd0d-569e-4169-a8c1-c055839bc2f4</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="134"
                  trans_unit_id="134-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="134">
            <SegmentId>21acdd0d-569e-4169-a8c1-c055839bc2f4</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="134"
              trans_unit_id="134-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="20c05fba-c329-4080-b5b8-6e75a0a836c9"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="20c05fba-c329-4080-b5b8-6e75a0a836c9">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>SELECT * 
FROM #Results
ORDER BY 1,2,3
;</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="1e79c64e-cc9d-4aff-a68e-c0911d776e4d"
        item_type="NormalParagraph"
        item_footer="&#xA;"
        trans_unit_id="1e79c64e-cc9d-4aff-a68e-c0911d776e4d">
        <Lines>
          <MarkdownLine>
            <LineId>1efa3988-d3dd-4dea-a981-68221aa73774</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="135">
                <SegmentId>270a31dc-5f07-4a9b-aab8-052b10307103</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="135"
                  trans_unit_id="135-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="135">
            <SegmentId>270a31dc-5f07-4a9b-aab8-052b10307103</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="135"
              trans_unit_id="135-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="430b5c59-aa57-4ef0-9118-867c8be4e257"
        item_type="Header"
        item_footer="footer_not_set"
        trans_unit_id="430b5c59-aa57-4ef0-9118-867c8be4e257">
        <segment
          trans_unit_id="136">
          <SegmentId>2f4c04ae-b833-40f2-a261-3b22d6b67d33</SegmentId>
          <InternalNormalItem
            internal_item_id="1"
            internal_item_parent_id="136"
            trans_unit_id="136-1"
            internal_item_type="Normal">
            <internal_items />
          </InternalNormalItem>
        </segment>
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="0475242d-5b6a-4766-b9c4-c6aef9647be7"
        item_type="NormalParagraph"
        item_footer="&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;"
        trans_unit_id="0475242d-5b6a-4766-b9c4-c6aef9647be7">
        <Lines>
          <MarkdownLine>
            <LineId>1bd7753f-599b-40b7-8d75-9a68f7453a0c</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="137">
                <SegmentId>031d375b-cf32-4e38-b719-495a5eb32c07</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="137"
                  trans_unit_id="137-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
                <LinkItem
                  internal_item_id="2"
                  internal_item_parent_id="137"
                  trans_unit_id="137-2"
                  internal_item_type="Link">
                  <internal_items />
                  <internal_link_type>Reference</internal_link_type>
                  <internal_link_text>development overview</internal_link_text>
                  <internal_link_id />
                </LinkItem>
                <InternalNormalItem
                  internal_item_id="3"
                  internal_item_parent_id="137"
                  trans_unit_id="137-3"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="137">
            <SegmentId>031d375b-cf32-4e38-b719-495a5eb32c07</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="137"
              trans_unit_id="137-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
            <LinkItem
              internal_item_id="2"
              internal_item_parent_id="137"
              trans_unit_id="137-2"
              internal_item_type="Link">
              <internal_items />
              <internal_link_type>Reference</internal_link_type>
              <internal_link_text>development overview</internal_link_text>
              <internal_link_id />
            </LinkItem>
            <InternalNormalItem
              internal_item_id="3"
              internal_item_parent_id="137"
              trans_unit_id="137-3"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
    </ArrayOfMarkdownBlockBase>
  </block_element>
  <references>
    <ArrayOfMarkdownLinkedReference xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <MarkdownLinkedReference
        item_id="beb6138e-b1dd-431e-b7a5-d452dbde405f"
        item_type="LinkedReference"
        item_footer="footer_not_set"
        trans_unit_id="beb6138e-b1dd-431e-b7a5-d452dbde405f">
        <link_id>1</link_id>
        <link_uri>media/sql-data-warehouse-develop-group-by-options/sql-data-warehouse-develop-group-by-cube.png</link_uri>
        <link_title />
      </MarkdownLinkedReference>
      <MarkdownLinkedReference
        item_id="6cac3f90-128e-4529-b2d3-77e821e11766"
        item_type="LinkedReference"
        item_footer="footer_not_set"
        trans_unit_id="6cac3f90-128e-4529-b2d3-77e821e11766">
        <link_id>development overview</link_id>
        <link_uri>sql-data-warehouse-overview-develop.md</link_uri>
        <link_title />
      </MarkdownLinkedReference>
      <MarkdownLinkedReference
        item_id="b0c8fd1f-f7d2-45e4-8b68-6f00dd66fc57"
        item_type="LinkedReference"
        item_footer="footer_not_set"
        trans_unit_id="b0c8fd1f-f7d2-45e4-8b68-6f00dd66fc57">
        <link_id>group by</link_id>
        <link_uri>https://msdn.microsoft.com/en-us/library/ms177673.aspx</link_uri>
        <link_title />
      </MarkdownLinkedReference>
    </ArrayOfMarkdownLinkedReference>
  </references>
</markdown_skeleton_root>