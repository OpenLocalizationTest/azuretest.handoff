<markdown_skeleton_root>
  <block_element>
    <ArrayOfMarkdownBlockBase xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <MarkdownBlockBase
        xsi:type="MarkdownAzureMetadataBlock"
        item_id="13fdc2ff-ca2e-49a4-8401-c173633ad7d0"
        item_type="AzureMetadata"
        item_footer="footer_not_set"
        trans_unit_id="13fdc2ff-ca2e-49a4-8401-c173633ad7d0">
        <LocalizeItemList>
          <MarkdownInternalXmlItem
            internal_item_id="3022456e-33c4-47e5-9836-7601ddbcb9ea"
            trans_unit_id="101"
            internal_item_type="Xml">
            <internal_items />
          </MarkdownInternalXmlItem>
          <MarkdownInternalXmlItem
            internal_item_id="9929b0af-9bf6-4502-8204-188c337ea148"
            trans_unit_id="102"
            internal_item_type="Xml">
            <internal_items />
          </MarkdownInternalXmlItem>
        </LocalizeItemList>
        <ItemValue>&lt;properties
   pageTitle="3022456e-33c4-47e5-9836-7601ddbcb9ea"
   description="9929b0af-9bf6-4502-8204-188c337ea148"
   services="sql-data-warehouse"
   documentationCenter="NA"
   authors="jrowlandjones"
   manager="barbkess"
   editor=""/&gt;

&lt;tags
   ms.service="sql-data-warehouse"
   ms.devlang="NA"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="data-services"
   ms.date="06/22/2015"
   ms.author="JRJ@BigBangData.co.uk;barbkess"/&gt;

</ItemValue>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="9e40b1c2-16d3-47ae-93f5-85c4da3d402a"
        item_type="Header"
        item_footer="footer_not_set"
        trans_unit_id="9e40b1c2-16d3-47ae-93f5-85c4da3d402a">
        <segment
          trans_unit_id="103">
          <SegmentId>3eede4c7-37c0-4fc6-88dd-99c512808920</SegmentId>
          <InternalNormalItem
            internal_item_id="1"
            internal_item_parent_id="103"
            trans_unit_id="103-1"
            internal_item_type="Normal">
            <internal_items />
          </InternalNormalItem>
        </segment>
        <header_type>Star</header_type>
        <header_level>1</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="c6434e9d-5565-4294-90a6-cce4bbc3efe4"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="c6434e9d-5565-4294-90a6-cce4bbc3efe4">
        <Lines>
          <MarkdownLine>
            <LineId>f9bcede7-4667-40a5-be8a-dab38cfb3b52</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="104">
                <SegmentId>ab976e67-e201-45f3-be45-d2f06a052279</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="104"
                  trans_unit_id="104-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="105">
                <SegmentId>b72a2213-1589-4f91-be3d-4d237f5965e1</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="105"
                  trans_unit_id="105-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="104">
            <SegmentId>ab976e67-e201-45f3-be45-d2f06a052279</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="104"
              trans_unit_id="104-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="105">
            <SegmentId>b72a2213-1589-4f91-be3d-4d237f5965e1</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="105"
              trans_unit_id="105-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="a7fe8101-e366-4122-a1a4-aa7273b51c72"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="a7fe8101-e366-4122-a1a4-aa7273b51c72">
        <Lines>
          <MarkdownLine>
            <LineId>5d13a2e4-7ded-4fbf-a295-579ade2fa4ef</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="106">
                <SegmentId>40eaaa1f-a40a-471c-ba17-37c44a350cb3</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="106"
                  trans_unit_id="106-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="106">
            <SegmentId>40eaaa1f-a40a-471c-ba17-37c44a350cb3</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="106"
              trans_unit_id="106-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="951864af-7775-4cb5-aa41-ea2b666f619d"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="951864af-7775-4cb5-aa41-ea2b666f619d">
        <Lines>
          <MarkdownLine>
            <LineId>6876ae3f-ba12-479f-b5be-b24b4fe29009</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="107">
                <SegmentId>c3b81c82-b614-485b-80eb-88200e31ee8b</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="107"
                  trans_unit_id="107-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="107">
            <SegmentId>c3b81c82-b614-485b-80eb-88200e31ee8b</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="107"
              trans_unit_id="107-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="e24dc23d-b7a9-4fcc-9ef1-ee2f375a26cd"
        item_type="Header"
        item_footer="footer_not_set"
        trans_unit_id="e24dc23d-b7a9-4fcc-9ef1-ee2f375a26cd">
        <segment
          trans_unit_id="108">
          <SegmentId>2f0d8b46-9a72-420a-a16f-156cb04e9ab8</SegmentId>
          <InternalNormalItem
            internal_item_id="1"
            internal_item_parent_id="108"
            trans_unit_id="108-1"
            internal_item_type="Normal">
            <internal_items />
          </InternalNormalItem>
        </segment>
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="82548445-1aa1-4bd9-b7d5-842694d5e02a"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="82548445-1aa1-4bd9-b7d5-842694d5e02a">
        <Lines>
          <MarkdownLine>
            <LineId>fc8717c9-a28e-4bcf-821b-0d84284f694d</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="109">
                <SegmentId>929d75e9-c936-468e-857a-9707a7cd721a</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="109"
                  trans_unit_id="109-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="109">
            <SegmentId>929d75e9-c936-468e-857a-9707a7cd721a</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="109"
              trans_unit_id="109-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="51f450a1-4be2-41e1-91cf-1dace9b4fa40"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="51f450a1-4be2-41e1-91cf-1dace9b4fa40">
        <Lines>
          <MarkdownLine>
            <LineId>71ca860a-ccdb-4caa-a89e-a94d3308c8fc</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="110">
                <SegmentId>eee096b3-e97a-407b-afe1-6e706d6a1cc4</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="110"
                  trans_unit_id="110-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="110">
            <SegmentId>eee096b3-e97a-407b-afe1-6e706d6a1cc4</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="110"
              trans_unit_id="110-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="77eb6058-a7b5-4ef0-8a61-8c43b34fbbc8"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="77eb6058-a7b5-4ef0-8a61-8c43b34fbbc8">
        <Lines>
          <MarkdownLine>
            <LineId>3c889fbb-a936-4076-9870-109b1d44d458</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="111">
                <SegmentId>400ee90c-e5a3-4268-9496-7f576f8aea52</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="111"
                  trans_unit_id="111-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="111">
            <SegmentId>400ee90c-e5a3-4268-9496-7f576f8aea52</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="111"
              trans_unit_id="111-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="c58fbf07-5f72-4e93-af8f-81aa91e2d0b8"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="c58fbf07-5f72-4e93-af8f-81aa91e2d0b8">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>CREATE PROCEDURE    [dbo].[prc_sqldw_update_stats]
(   @update_type    tinyint -- 1 default 2 fullscan 3 sample 4 resample
,   @sample_pct     tinyint
)
AS

IF @update_type NOT IN (1,2,3,4)
BEGIN;
    THROW 151000,'Invalid value for @update_type parameter. Valid range 1 (default), 2 (fullscan), 3 (sample) or 4 (resample).',1;
END;

IF @sample_pct IS NULL
BEGIN;
    SET @sample_pct = 20;
END;

CREATE TABLE #stats_ddl
WITH    (   DISTRIBUTION = HASH([seq_nmbr])
        ,   LOCATION     = USER_DB
        )
WITH t1
AS
(
SELECT
        sm.[name]                                                               AS [schema_name]
,       tb.[name]                                                               AS [table_name]
,       st.[name]                                                               AS [stats_name]
,       st.[has_filter]                                                         AS [stats_is_filtered]
,       ROW_NUMBER()
        OVER(ORDER BY (SELECT NULL))                                            AS [seq_nmbr]
,                                QUOTENAME(sm.[name])+'.'+QUOTENAME(tb.[name])  AS [two_part_name]
,       QUOTENAME(DB_NAME())+'.'+QUOTENAME(sm.[name])+'.'+QUOTENAME(tb.[name])  AS [three_part_name]
FROM    sys.objects         AS ob
JOIN    sys.stats           AS st   ON  ob.[object_id]      = st.[object_id]
JOIN    sys.stats_columns   AS sc   ON  st.[stats_id]       = sc.[stats_id]
                                    AND st.[object_id]      = sc.[object_id]
JOIN    sys.columns         AS co   ON  sc.[column_id]      = co.[column_id]
                                    AND sc.[object_id]      = co.[object_id]
JOIN    sys.tables          AS tb   ON  co.[object_id]      = tb.[object_id]
JOIN    sys.schemas         AS sm   ON  tb.[schema_id]      = sm.[schema_id]
WHERE   1=1
AND     st.[user_created]   = 1
GROUP BY
        sm.[name]
,       tb.[name]
,       st.[name]
,       st.[filter_definition]
,       st.[has_filter]
)
SELECT
    CASE @update_type
    WHEN 1
    THEN 'UPDATE STATISTICS '+[two_part_name]+'('+[stats_name]+');'
    WHEN 2
    THEN 'UPDATE STATISTICS '+[two_part_name]+'('+[stats_name]+') WITH FULLSCAN;'
    WHEN 3
    THEN 'UPDATE STATISTICS '+[two_part_name]+'('+[stats_name]+') WITH SAMPLE '+CAST(@sample_pct AS VARCHAR(20))+' PERCENT;'
    WHEN 4
    THEN 'UPDATE STATISTICS '+[two_part_name]+'('+[stats_name]+') WITH RESAMPLE;'
    END AS [update_stats_ddl]
,   [seq_nmbr]
FROM    t1
;</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="83bcea6c-41e6-4310-beec-27e619f5069d"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="83bcea6c-41e6-4310-beec-27e619f5069d">
        <Lines>
          <MarkdownLine>
            <LineId>ef967d80-ebf9-410f-b153-9d96659c2839</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="112">
                <SegmentId>d94235fa-1974-4e70-973f-bd2cf28a5e13</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="112"
                  trans_unit_id="112-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="113">
                <SegmentId>7da1cded-7620-43aa-ad83-aa79e83994c0</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="113"
                  trans_unit_id="113-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="112">
            <SegmentId>d94235fa-1974-4e70-973f-bd2cf28a5e13</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="112"
              trans_unit_id="112-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="113">
            <SegmentId>7da1cded-7620-43aa-ad83-aa79e83994c0</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="113"
              trans_unit_id="113-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="81e60eee-62ed-4fa2-b3ed-d35f3e65c158"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="81e60eee-62ed-4fa2-b3ed-d35f3e65c158">
        <Lines>
          <MarkdownLine>
            <LineId>e85a1a2d-2853-4800-b092-b903804f5648</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="114">
                <SegmentId>93226465-9de4-430f-8d18-9c4c3e613284</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="114"
                  trans_unit_id="114-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="115">
                <SegmentId>fb12cea3-ba78-4efe-91e7-e455b129a319</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="115"
                  trans_unit_id="115-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="116">
                <SegmentId>a96517e2-62d0-4cc0-aa4a-2cff7d8eeaed</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="116"
                  trans_unit_id="116-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
                <MarkdownInternalBoldItem
                  internal_item_id="2"
                  internal_item_parent_id="116"
                  trans_unit_id="116-2"
                  internal_item_type="Bold">
                  <internal_items />
                  <internal_itatic_bold_item_type>Star</internal_itatic_bold_item_type>
                </MarkdownInternalBoldItem>
                <InternalNormalItem
                  internal_item_id="3"
                  internal_item_parent_id="116"
                  trans_unit_id="116-3"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="114">
            <SegmentId>93226465-9de4-430f-8d18-9c4c3e613284</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="114"
              trans_unit_id="114-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="115">
            <SegmentId>fb12cea3-ba78-4efe-91e7-e455b129a319</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="115"
              trans_unit_id="115-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="116">
            <SegmentId>a96517e2-62d0-4cc0-aa4a-2cff7d8eeaed</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="116"
              trans_unit_id="116-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
            <MarkdownInternalBoldItem
              internal_item_id="2"
              internal_item_parent_id="116"
              trans_unit_id="116-2"
              internal_item_type="Bold">
              <internal_items />
              <internal_itatic_bold_item_type>Star</internal_itatic_bold_item_type>
            </MarkdownInternalBoldItem>
            <InternalNormalItem
              internal_item_id="3"
              internal_item_parent_id="116"
              trans_unit_id="116-3"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="1e263928-3f7a-4ca3-9ffc-264c476025da"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="1e263928-3f7a-4ca3-9ffc-264c476025da">
        <Lines>
          <MarkdownLine>
            <LineId>fd2b0bf5-9ae9-47e3-bc75-458bf676dfe9</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="117">
                <SegmentId>561f5801-66bb-48b6-97bd-ae538f805f0e</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="117"
                  trans_unit_id="117-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="117">
            <SegmentId>561f5801-66bb-48b6-97bd-ae538f805f0e</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="117"
              trans_unit_id="117-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="74823245-0233-4498-9f58-a5efec57d897"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="74823245-0233-4498-9f58-a5efec57d897">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>EXEC [dbo].[prc_sqldw_update_stats] @update_type = 1, @sample_pct = NULL;

DECLARE @i INT              = 1
,       @t INT              = (SELECT COUNT(*) FROM #stats_ddl)
,       @s NVARCHAR(4000)   = N''

WHILE @i &lt;= @t
BEGIN
    SET @s=(SELECT update_stats_ddl FROM #stats_ddl WHERE seq_nmbr = @i);

    PRINT @s
    EXEC sp_executesql @s
    SET @i+=1;
END

DROP TABLE #stats_ddl;</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="33b3cb77-389a-408c-ac76-22b917dc0e8a"
        item_type="NormalParagraph"
        item_footer="footer_not_set"
        trans_unit_id="33b3cb77-389a-408c-ac76-22b917dc0e8a">
        <Lines>
          <MarkdownLine>
            <LineId>b2abb2be-8098-4ae0-8270-1de70f13961e</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="118">
                <SegmentId>d79802f8-dab6-46d6-92c1-d06c81384a1f</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="118"
                  trans_unit_id="118-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="118">
            <SegmentId>d79802f8-dab6-46d6-92c1-d06c81384a1f</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="118"
              trans_unit_id="118-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownNoteBlock"
        item_id="782bd24f-a2aa-4d08-9b7b-b06c8659f573"
        item_type="Note"
        item_footer=""
        trans_unit_id="782bd24f-a2aa-4d08-9b7b-b06c8659f573">
        <Lines>
          <MarkdownLine>
            <LineId>63620f95-f848-4080-bcc1-737d0c76d238</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="119">
                <SegmentId>d3c6a91a-bf45-419f-bc82-4e7a12c08e9d</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="119"
                  trans_unit_id="119-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="120">
                <SegmentId>66b6295f-a0db-447b-91f4-d43f052db4f8</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="120"
                  trans_unit_id="120-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <NoteSign>&gt; [AZURE.NOTE] </NoteSign>
        <Prefixes>
          <string />
        </Prefixes>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="119">
            <SegmentId>d3c6a91a-bf45-419f-bc82-4e7a12c08e9d</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="119"
              trans_unit_id="119-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="120">
            <SegmentId>66b6295f-a0db-447b-91f4-d43f052db4f8</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="120"
              trans_unit_id="120-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="db658f8a-2b40-4828-bb5b-7d97396bd1a1"
        item_type="Header"
        item_footer="footer_not_set"
        trans_unit_id="db658f8a-2b40-4828-bb5b-7d97396bd1a1">
        <segment
          trans_unit_id="121">
          <SegmentId>bf59a3cb-3b69-442d-874f-6a25cf236314</SegmentId>
          <InternalNormalItem
            internal_item_id="1"
            internal_item_parent_id="121"
            trans_unit_id="121-1"
            internal_item_type="Normal">
            <internal_items />
          </InternalNormalItem>
        </segment>
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="4bb6e5d0-403b-41d0-809b-05f94098bacc"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="4bb6e5d0-403b-41d0-809b-05f94098bacc">
        <Lines>
          <MarkdownLine>
            <LineId>bd132767-d91d-46b3-b19e-b8b1356e0416</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="122">
                <SegmentId>04937814-e5b7-4211-b4bc-267f1d6a6eca</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="122"
                  trans_unit_id="122-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="122">
            <SegmentId>04937814-e5b7-4211-b4bc-267f1d6a6eca</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="122"
              trans_unit_id="122-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="49364e87-e5a3-4d81-ada7-cb3dc381a3d3"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="49364e87-e5a3-4d81-ada7-cb3dc381a3d3">
        <Lines>
          <MarkdownLine>
            <LineId>b7addf36-2658-48f8-8441-3440653b65fa</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="123">
                <SegmentId>9d4d5fb9-90be-460e-808b-119afdbc3e70</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="123"
                  trans_unit_id="123-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="123">
            <SegmentId>9d4d5fb9-90be-460e-808b-119afdbc3e70</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="123"
              trans_unit_id="123-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownListBlock"
        item_id="5647d4de-ade5-4e4e-b36c-da4b9ac5034b"
        item_type="List"
        item_footer="&#xA;"
        trans_unit_id="5647d4de-ade5-4e4e-b36c-da4b9ac5034b">
        <inner_list_items>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="0de354d1-b261-458d-94cb-580b3eed574d"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="0de354d1-b261-458d-94cb-580b3eed574d">
              <Lines>
                <MarkdownLine>
                  <LineId>09b832dc-9024-4325-a437-4ee190e937fc</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="124">
                      <SegmentId>4a6c96a2-63ce-4036-8393-70b58588158c</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="124"
                        trans_unit_id="124-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="124">
                  <SegmentId>4a6c96a2-63ce-4036-8393-70b58588158c</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="124"
                    trans_unit_id="124-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="b22d425a-cb66-47ee-b7fe-12c91c0a27fc"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="b22d425a-cb66-47ee-b7fe-12c91c0a27fc">
              <Lines>
                <MarkdownLine>
                  <LineId>9902d9dd-680a-4cb0-b7fe-6ddcd7acaacf</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="125">
                      <SegmentId>9f924291-3ad7-4b5a-946d-9f78ec617768</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="125"
                        trans_unit_id="125-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="125">
                  <SegmentId>9f924291-3ad7-4b5a-946d-9f78ec617768</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="125"
                    trans_unit_id="125-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
        </inner_list_items>
        <ListType>Charactor</ListType>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="1ca26e9f-1f63-4767-8dc1-935ae0a8c56a"
        item_type="Header"
        item_footer="footer_not_set"
        trans_unit_id="1ca26e9f-1f63-4767-8dc1-935ae0a8c56a">
        <segment
          trans_unit_id="126">
          <SegmentId>a4fdd64d-781b-4842-a403-725af0954ad3</SegmentId>
          <InternalNormalItem
            internal_item_id="1"
            internal_item_parent_id="126"
            trans_unit_id="126-1"
            internal_item_type="Normal">
            <internal_items />
          </InternalNormalItem>
        </segment>
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="37b3f6dc-1e76-4b1d-94e7-cf3ebf172d27"
        item_type="NormalParagraph"
        item_footer="&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;"
        trans_unit_id="37b3f6dc-1e76-4b1d-94e7-cf3ebf172d27">
        <Lines>
          <MarkdownLine>
            <LineId>3c49e2a8-7a49-4f06-8106-0a74f3730420</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="127">
                <SegmentId>d2f0ea3a-1b2d-4004-b432-8e07bec21a38</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="127"
                  trans_unit_id="127-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
                <LinkItem
                  internal_item_id="2"
                  internal_item_parent_id="127"
                  trans_unit_id="127-2"
                  internal_item_type="Link">
                  <internal_items />
                  <internal_link_type>Reference</internal_link_type>
                  <internal_link_text>development overview</internal_link_text>
                  <internal_link_id />
                </LinkItem>
                <InternalNormalItem
                  internal_item_id="3"
                  internal_item_parent_id="127"
                  trans_unit_id="127-3"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="127">
            <SegmentId>d2f0ea3a-1b2d-4004-b432-8e07bec21a38</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="127"
              trans_unit_id="127-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
            <LinkItem
              internal_item_id="2"
              internal_item_parent_id="127"
              trans_unit_id="127-2"
              internal_item_type="Link">
              <internal_items />
              <internal_link_type>Reference</internal_link_type>
              <internal_link_text>development overview</internal_link_text>
              <internal_link_id />
            </LinkItem>
            <InternalNormalItem
              internal_item_id="3"
              internal_item_parent_id="127"
              trans_unit_id="127-3"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
    </ArrayOfMarkdownBlockBase>
  </block_element>
  <references>
    <ArrayOfMarkdownLinkedReference xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <MarkdownLinkedReference
        item_id="fcef9933-bcfe-4ff2-beef-d9f89df23203"
        item_type="LinkedReference"
        item_footer="footer_not_set"
        trans_unit_id="fcef9933-bcfe-4ff2-beef-d9f89df23203">
        <link_id>development overview</link_id>
        <link_uri>sql-data-warehouse-overview-develop.md</link_uri>
        <link_title />
      </MarkdownLinkedReference>
    </ArrayOfMarkdownLinkedReference>
  </references>
</markdown_skeleton_root>