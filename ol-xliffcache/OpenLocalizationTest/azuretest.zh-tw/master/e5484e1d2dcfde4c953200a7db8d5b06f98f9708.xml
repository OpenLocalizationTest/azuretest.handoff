<markdown_skeleton_root>
  <block_element>
    <ArrayOfMarkdownBlockBase xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <MarkdownBlockBase
        xsi:type="MarkdownAzureMetadataBlock"
        item_id="32ed4055-3d27-4a0f-883f-f601f6255b05"
        item_type="AzureMetadata"
        item_footer="footer_not_set"
        trans_unit_id="32ed4055-3d27-4a0f-883f-f601f6255b05">
        <LocalizeItemList>
          <MarkdownInternalXmlItem
            internal_item_id="7389db79-49c0-476e-9e02-d3c598ee79bc"
            trans_unit_id="101"
            internal_item_type="Xml">
            <internal_items />
          </MarkdownInternalXmlItem>
          <MarkdownInternalXmlItem
            internal_item_id="0ea91380-3539-4c5f-8f47-86256391e52d"
            trans_unit_id="102"
            internal_item_type="Xml">
            <internal_items />
          </MarkdownInternalXmlItem>
        </LocalizeItemList>
        <ItemValue>&lt;properties
   pageTitle="7389db79-49c0-476e-9e02-d3c598ee79bc"
   description="0ea91380-3539-4c5f-8f47-86256391e52d"
   services="sql-data-warehouse"
   documentationCenter="NA"
   authors="jrowlandjones"
   manager="barbkess"
   editor=""/&gt;

&lt;tags
   ms.service="sql-data-warehouse"
   ms.devlang="NA"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="data-services"
   ms.date="06/26/2015"
   ms.author="JRJ@BigBangData.co.uk;barbkess"/&gt;

</ItemValue>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="d57eab2f-3a50-42f4-998e-4aa765cc4098"
        item_type="Header"
        item_footer="footer_not_set"
        trans_unit_id="d57eab2f-3a50-42f4-998e-4aa765cc4098">
        <segment
          trans_unit_id="103">
          <SegmentId>4834308f-2534-4fb1-b383-95127748bea1</SegmentId>
          <InternalNormalItem
            internal_item_id="1"
            internal_item_parent_id="103"
            trans_unit_id="103-1"
            internal_item_type="Normal">
            <internal_items />
          </InternalNormalItem>
        </segment>
        <header_type>Star</header_type>
        <header_level>1</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="a7db7155-3907-4e88-930d-a1ab4d81440f"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="a7db7155-3907-4e88-930d-a1ab4d81440f">
        <Lines>
          <MarkdownLine>
            <LineId>63788b81-0589-4eb9-b9c0-99c9f86fa316</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="104">
                <SegmentId>074fcb5b-b8fa-4b90-ac1e-d3facb63a754</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="104"
                  trans_unit_id="104-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="105">
                <SegmentId>d4f00be5-65d4-48ef-b16c-36993e48b165</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="105"
                  trans_unit_id="105-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="104">
            <SegmentId>074fcb5b-b8fa-4b90-ac1e-d3facb63a754</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="104"
              trans_unit_id="104-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="105">
            <SegmentId>d4f00be5-65d4-48ef-b16c-36993e48b165</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="105"
              trans_unit_id="105-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="69995175-990b-429e-a2fa-8a3a24a2ea9b"
        item_type="NormalParagraph"
        item_footer="footer_not_set"
        trans_unit_id="69995175-990b-429e-a2fa-8a3a24a2ea9b">
        <Lines>
          <MarkdownLine>
            <LineId>1dcdba65-2215-4e07-a429-6b9ff30ee720</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="106">
                <SegmentId>e21acc8c-0558-4dbe-bbc9-b53171344718</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="106"
                  trans_unit_id="106-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="106">
            <SegmentId>e21acc8c-0558-4dbe-bbc9-b53171344718</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="106"
              trans_unit_id="106-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownListBlock"
        item_id="344356b9-f504-4c05-ae48-306e2641ddd0"
        item_type="List"
        item_footer=""
        trans_unit_id="344356b9-f504-4c05-ae48-306e2641ddd0">
        <inner_list_items>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="f372afd5-a464-47cb-bde6-091171c1872b"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="f372afd5-a464-47cb-bde6-091171c1872b">
              <Lines>
                <MarkdownLine>
                  <LineId>5e7059d1-f3d7-4f4e-896a-2d50c877b1cd</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="107">
                      <SegmentId>949e4ef6-02de-4b87-8894-692bea7103b5</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="107"
                        trans_unit_id="107-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="107">
                  <SegmentId>949e4ef6-02de-4b87-8894-692bea7103b5</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="107"
                    trans_unit_id="107-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="1d85260d-23c5-4092-b884-15ff4af3646f"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="1d85260d-23c5-4092-b884-15ff4af3646f">
              <Lines>
                <MarkdownLine>
                  <LineId>784c386e-578f-4fbb-93a1-dd156e745089</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="108">
                      <SegmentId>37bffaf3-9ff6-4735-b43f-7a34d65b85d8</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="108"
                        trans_unit_id="108-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="108">
                  <SegmentId>37bffaf3-9ff6-4735-b43f-7a34d65b85d8</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="108"
                    trans_unit_id="108-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="337404bb-edb3-47e0-9a7e-f67838eb9631"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="337404bb-edb3-47e0-9a7e-f67838eb9631">
              <Lines>
                <MarkdownLine>
                  <LineId>59dac92e-f912-4428-8c7e-0e843da3f3b5</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="109">
                      <SegmentId>ff9834bc-de3f-4db3-bfe8-bd6e9603fc13</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="109"
                        trans_unit_id="109-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="109">
                  <SegmentId>ff9834bc-de3f-4db3-bfe8-bd6e9603fc13</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="109"
                    trans_unit_id="109-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
        </inner_list_items>
        <ListType>Charactor</ListType>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="eaca9dbf-f04c-477c-bf60-de8cfbb46474"
        item_type="Header"
        item_footer="footer_not_set"
        trans_unit_id="eaca9dbf-f04c-477c-bf60-de8cfbb46474">
        <segment
          trans_unit_id="110">
          <SegmentId>1d4c84ba-1842-4604-b60c-9903aca271fb</SegmentId>
          <InternalNormalItem
            internal_item_id="1"
            internal_item_parent_id="110"
            trans_unit_id="110-1"
            internal_item_type="Normal">
            <internal_items />
          </InternalNormalItem>
        </segment>
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="41c2194a-4420-4ded-ac03-4512e873be3c"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="41c2194a-4420-4ded-ac03-4512e873be3c">
        <Lines>
          <MarkdownLine>
            <LineId>ec2b0b40-be78-4be4-a5c0-4583bbf62f9d</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="111">
                <SegmentId>ab7a730e-81ad-40c2-a2d8-cd1a5262d44c</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="111"
                  trans_unit_id="111-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
                <CodeSpanItem
                  internal_item_id="2"
                  internal_item_parent_id="111"
                  trans_unit_id="111-2"
                  internal_item_type="CodeSpan">
                  <internal_items />
                  <ItemValue>UNION ALL</ItemValue>
                </CodeSpanItem>
                <InternalNormalItem
                  internal_item_id="3"
                  internal_item_parent_id="111"
                  trans_unit_id="111-3"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="112">
                <SegmentId>3761451a-056d-45a3-911b-49bbcd97ff71</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="112"
                  trans_unit_id="112-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="111">
            <SegmentId>ab7a730e-81ad-40c2-a2d8-cd1a5262d44c</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="111"
              trans_unit_id="111-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
            <CodeSpanItem
              internal_item_id="2"
              internal_item_parent_id="111"
              trans_unit_id="111-2"
              internal_item_type="CodeSpan">
              <internal_items />
              <ItemValue>UNION ALL</ItemValue>
            </CodeSpanItem>
            <InternalNormalItem
              internal_item_id="3"
              internal_item_parent_id="111"
              trans_unit_id="111-3"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="112">
            <SegmentId>3761451a-056d-45a3-911b-49bbcd97ff71</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="112"
              trans_unit_id="112-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="41520e92-b37d-40cf-9f77-7234ebdad5f9"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="41520e92-b37d-40cf-9f77-7234ebdad5f9">
        <Lines>
          <MarkdownLine>
            <LineId>066b7ee6-756c-4e3d-a9a1-8e54e600cd30</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="113">
                <SegmentId>98361abb-5ac0-4bc9-9313-a119513fc568</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="113"
                  trans_unit_id="113-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
                <CodeSpanItem
                  internal_item_id="2"
                  internal_item_parent_id="113"
                  trans_unit_id="113-2"
                  internal_item_type="CodeSpan">
                  <internal_items />
                  <ItemValue>ROLLUP</ItemValue>
                </CodeSpanItem>
                <InternalNormalItem
                  internal_item_id="3"
                  internal_item_parent_id="113"
                  trans_unit_id="113-3"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="113">
            <SegmentId>98361abb-5ac0-4bc9-9313-a119513fc568</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="113"
              trans_unit_id="113-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
            <CodeSpanItem
              internal_item_id="2"
              internal_item_parent_id="113"
              trans_unit_id="113-2"
              internal_item_type="CodeSpan">
              <internal_items />
              <ItemValue>ROLLUP</ItemValue>
            </CodeSpanItem>
            <InternalNormalItem
              internal_item_id="3"
              internal_item_parent_id="113"
              trans_unit_id="113-3"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="46c32512-f02c-4318-8f8d-7b7653d48e3b"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="46c32512-f02c-4318-8f8d-7b7653d48e3b">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>SELECT [SalesTerritoryCountry]
,      [SalesTerritoryRegion]
,      SUM(SalesAmount)             AS TotalSalesAmount
FROM  dbo.factInternetSales s
JOIN  dbo.DimSalesTerritory t       ON s.SalesTerritoryKey       = t.SalesTerritoryKey
GROUP BY ROLLUP (
                        [SalesTerritoryCountry]
                ,       [SalesTerritoryRegion]
                )
;</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="44eaaccc-91da-4a5d-8e11-e10952f72eac"
        item_type="NormalParagraph"
        item_footer="footer_not_set"
        trans_unit_id="44eaaccc-91da-4a5d-8e11-e10952f72eac">
        <Lines>
          <MarkdownLine>
            <LineId>56783e77-976a-4e95-bea8-332ef0377ff0</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="114">
                <SegmentId>f8a60cbe-820c-4d17-840b-d9ab02b8d42d</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="114"
                  trans_unit_id="114-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="114">
            <SegmentId>f8a60cbe-820c-4d17-840b-d9ab02b8d42d</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="114"
              trans_unit_id="114-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownListBlock"
        item_id="27a57f2c-1a46-4dcd-aeb2-e5d4b8f12b97"
        item_type="List"
        item_footer=""
        trans_unit_id="27a57f2c-1a46-4dcd-aeb2-e5d4b8f12b97">
        <inner_list_items>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="af21c2f5-dabb-42c7-98a8-d145fc90e117"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="af21c2f5-dabb-42c7-98a8-d145fc90e117">
              <Lines>
                <MarkdownLine>
                  <LineId>680b871f-0bcc-46aa-bc10-5089f0735601</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="115">
                      <SegmentId>ca62b639-5393-4faf-903a-3bf6b20781d5</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="115"
                        trans_unit_id="115-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="115">
                  <SegmentId>ca62b639-5393-4faf-903a-3bf6b20781d5</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="115"
                    trans_unit_id="115-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="38bf17a6-8dc9-4b64-a61c-a97496247540"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="38bf17a6-8dc9-4b64-a61c-a97496247540">
              <Lines>
                <MarkdownLine>
                  <LineId>c55611f0-3b6d-4ec7-8ae0-b65ce9a6af18</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="116">
                      <SegmentId>839f9f79-aab7-491f-8042-9417a154ed6f</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="116"
                        trans_unit_id="116-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="116">
                  <SegmentId>839f9f79-aab7-491f-8042-9417a154ed6f</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="116"
                    trans_unit_id="116-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="ad4e556f-3445-4d7b-894d-398de4d0d6a8"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="ad4e556f-3445-4d7b-894d-398de4d0d6a8">
              <Lines>
                <MarkdownLine>
                  <LineId>0c8667d5-0268-4309-ab2f-1781539bc109</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="117">
                      <SegmentId>ba37e3f4-fc64-4025-9462-0e8af79bf2ea</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="117"
                        trans_unit_id="117-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="117">
                  <SegmentId>ba37e3f4-fc64-4025-9462-0e8af79bf2ea</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="117"
                    trans_unit_id="117-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
        </inner_list_items>
        <ListType>Charactor</ListType>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="a71f94ef-3334-4b3c-8067-d913185cf5a8"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="a71f94ef-3334-4b3c-8067-d913185cf5a8">
        <Lines>
          <MarkdownLine>
            <LineId>9c183820-327e-46e1-920a-98fa02fde42c</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="118">
                <SegmentId>3e7d66be-092e-4428-9b53-1541eb3b74a7</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="118"
                  trans_unit_id="118-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
                <CodeSpanItem
                  internal_item_id="2"
                  internal_item_parent_id="118"
                  trans_unit_id="118-2"
                  internal_item_type="CodeSpan">
                  <internal_items />
                  <ItemValue>UNION ALL</ItemValue>
                </CodeSpanItem>
                <InternalNormalItem
                  internal_item_id="3"
                  internal_item_parent_id="118"
                  trans_unit_id="118-3"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="118">
            <SegmentId>3e7d66be-092e-4428-9b53-1541eb3b74a7</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="118"
              trans_unit_id="118-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
            <CodeSpanItem
              internal_item_id="2"
              internal_item_parent_id="118"
              trans_unit_id="118-2"
              internal_item_type="CodeSpan">
              <internal_items />
              <ItemValue>UNION ALL</ItemValue>
            </CodeSpanItem>
            <InternalNormalItem
              internal_item_id="3"
              internal_item_parent_id="118"
              trans_unit_id="118-3"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="928b27a7-e199-45ab-8356-65535d0270aa"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="928b27a7-e199-45ab-8356-65535d0270aa">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>SELECT [SalesTerritoryCountry]
,      [SalesTerritoryRegion]
,      SUM(SalesAmount) AS TotalSalesAmount
FROM  dbo.factInternetSales s
JOIN  dbo.DimSalesTerritory t     ON s.SalesTerritoryKey       = t.SalesTerritoryKey
GROUP BY 
       [SalesTerritoryCountry]
,      [SalesTerritoryRegion]
UNION ALL
SELECT [SalesTerritoryCountry]
,      NULL
,      SUM(SalesAmount) AS TotalSalesAmount
FROM  dbo.factInternetSales s
JOIN  dbo.DimSalesTerritory t     ON s.SalesTerritoryKey       = t.SalesTerritoryKey
GROUP BY 
       [SalesTerritoryCountry]
UNION ALL
SELECT NULL
,      NULL
,      SUM(SalesAmount) AS TotalSalesAmount
FROM  dbo.factInternetSales s
JOIN  dbo.DimSalesTerritory t     ON s.SalesTerritoryKey       = t.SalesTerritoryKey;</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="ddaf7bea-1edd-4afb-9f5c-23fbe39f45e9"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="ddaf7bea-1edd-4afb-9f5c-23fbe39f45e9">
        <Lines>
          <MarkdownLine>
            <LineId>d5f7bcb9-429c-40aa-8a4a-c68993a12fce</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="119">
                <SegmentId>9d1e7b57-3483-49f9-8e47-e36df7f7973c</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="119"
                  trans_unit_id="119-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="119">
            <SegmentId>9d1e7b57-3483-49f9-8e47-e36df7f7973c</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="119"
              trans_unit_id="119-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="8c5b40d8-eba0-4b97-b75d-47d75d0e261f"
        item_type="Header"
        item_footer="footer_not_set"
        trans_unit_id="8c5b40d8-eba0-4b97-b75d-47d75d0e261f">
        <segment
          trans_unit_id="120">
          <SegmentId>91f5849f-a7dd-4871-8063-acbf8345129d</SegmentId>
          <InternalNormalItem
            internal_item_id="1"
            internal_item_parent_id="120"
            trans_unit_id="120-1"
            internal_item_type="Normal">
            <internal_items />
          </InternalNormalItem>
        </segment>
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="ab2f6bb0-8cf7-4eae-bc4b-74133b8d45d0"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="ab2f6bb0-8cf7-4eae-bc4b-74133b8d45d0">
        <Lines>
          <MarkdownLine>
            <LineId>b58a54cc-008b-4f17-8703-26668ae8c8bf</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="121">
                <SegmentId>3c9e0bbd-e953-4624-b76f-0c47a2f10a7c</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="121"
                  trans_unit_id="121-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="122">
                <SegmentId>22f0628a-d5dd-4056-82cb-bbca313354e1</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="122"
                  trans_unit_id="122-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="123">
                <SegmentId>00df998e-eab0-4831-876d-795f9d3e5d2f</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="123"
                  trans_unit_id="123-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="121">
            <SegmentId>3c9e0bbd-e953-4624-b76f-0c47a2f10a7c</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="121"
              trans_unit_id="121-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="122">
            <SegmentId>22f0628a-d5dd-4056-82cb-bbca313354e1</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="122"
              trans_unit_id="122-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="123">
            <SegmentId>00df998e-eab0-4831-876d-795f9d3e5d2f</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="123"
              trans_unit_id="123-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="986b1cb8-2777-47ee-825f-a385f758bf56"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="986b1cb8-2777-47ee-825f-a385f758bf56">
        <Lines>
          <MarkdownLine>
            <LineId>f13b1039-06ed-4dd3-a420-b3ed9405a153</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="124">
                <SegmentId>9925fda2-15ad-4d5c-921c-83743bc3ff8e</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="124"
                  trans_unit_id="124-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="124">
            <SegmentId>9925fda2-15ad-4d5c-921c-83743bc3ff8e</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="124"
              trans_unit_id="124-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="b84558d8-b4a5-4cd9-b5eb-b54488c5b8eb"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="b84558d8-b4a5-4cd9-b5eb-b54488c5b8eb">
        <Lines>
          <MarkdownLine>
            <LineId>ae684d99-2599-4fbc-8abd-a456c9a393e9</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="125">
                <SegmentId>59c98804-eb78-4667-a063-121f03af8c01</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="125"
                  trans_unit_id="125-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="126">
                <SegmentId>6e86e17e-d6fc-44fc-bd46-b2fbbeeb89e3</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="126"
                  trans_unit_id="126-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="127">
                <SegmentId>4ab9e870-f828-462c-82d8-a878569da8f8</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="127"
                  trans_unit_id="127-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="128">
                <SegmentId>225e3361-64e0-47b4-ab68-dba6f87e708a</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="128"
                  trans_unit_id="128-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="125">
            <SegmentId>59c98804-eb78-4667-a063-121f03af8c01</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="125"
              trans_unit_id="125-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="126">
            <SegmentId>6e86e17e-d6fc-44fc-bd46-b2fbbeeb89e3</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="126"
              trans_unit_id="126-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="127">
            <SegmentId>4ab9e870-f828-462c-82d8-a878569da8f8</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="127"
              trans_unit_id="127-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="128">
            <SegmentId>225e3361-64e0-47b4-ab68-dba6f87e708a</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="128"
              trans_unit_id="128-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="db00d9d6-7ef6-4a67-b9d9-931bbed81621"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="db00d9d6-7ef6-4a67-b9d9-931bbed81621">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>CREATE TABLE #Cube
WITH 
(   DISTRIBUTION = ROUND_ROBIN
,   LOCATION = USER_DB
)
AS
WITH GrpCube AS
(SELECT    CAST(ISNULL(Country,'NULL')+','+ISNULL(Region,'NULL') AS NVARCHAR(50)) as 'Cols'
,          CAST(ISNULL(Country+',','')+ISNULL(Region,'') AS NVARCHAR(50))  as 'GroupBy'
,          ROW_NUMBER() OVER (ORDER BY Country) as 'Seq'
FROM       ( SELECT 'SalesTerritoryCountry' as Country
             UNION ALL
             SELECT NULL
           ) c
CROSS JOIN ( SELECT 'SalesTerritoryRegion' as Region
             UNION ALL
             SELECT NULL
           ) r
)
SELECT Cols
,      CASE WHEN SUBSTRING(GroupBy,LEN(GroupBy),1) = ',' 
            THEN SUBSTRING(GroupBy,1,LEN(GroupBy)-1) 
            ELSE GroupBy 
       END AS GroupBy  --Remove Trailing Comma
,Seq
FROM GrpCube;</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="56c2f370-04f5-4cc7-8fe1-a61527d8dced"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="56c2f370-04f5-4cc7-8fe1-a61527d8dced">
        <Lines>
          <MarkdownLine>
            <LineId>81942ece-8ee0-4a26-a5d9-c590dd6e088d</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="129">
                <SegmentId>0c2a7d6f-0b1e-45af-afd1-8ed4e44d86cc</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="129"
                  trans_unit_id="129-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="129">
            <SegmentId>0c2a7d6f-0b1e-45af-afd1-8ed4e44d86cc</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="129"
              trans_unit_id="129-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="0a924f70-aa5f-4a96-bb8c-c2a9bf8d89b4"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="0a924f70-aa5f-4a96-bb8c-c2a9bf8d89b4">
        <Lines>
          <MarkdownLine>
            <LineId>1db155f6-da3c-491e-884f-0c7822528e4b</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="130">
                <SegmentId>fb99a146-03b9-4dc0-9969-f955bf6d6792</SegmentId>
                <ImageItem
                  internal_item_id="1"
                  internal_item_parent_id="130"
                  trans_unit_id="130-1"
                  internal_item_type="Image">
                  <internal_items />
                  <internal_Image_type>Reference</internal_Image_type>
                  <internal_link_text />
                  <internal_link_id>1</internal_link_id>
                </ImageItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="130">
            <SegmentId>fb99a146-03b9-4dc0-9969-f955bf6d6792</SegmentId>
            <ImageItem
              internal_item_id="1"
              internal_item_parent_id="130"
              trans_unit_id="130-1"
              internal_item_type="Image">
              <internal_items />
              <internal_Image_type>Reference</internal_Image_type>
              <internal_link_text />
              <internal_link_id>1</internal_link_id>
            </ImageItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="6048f16a-5058-49ae-9119-964ae592fe60"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="6048f16a-5058-49ae-9119-964ae592fe60">
        <Lines>
          <MarkdownLine>
            <LineId>28e74bf0-de4f-49ed-b0fd-45b38208877c</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="131">
                <SegmentId>d60391fa-8568-4021-8b71-8c648b40cf28</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="131"
                  trans_unit_id="131-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="131">
            <SegmentId>d60391fa-8568-4021-8b71-8c648b40cf28</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="131"
              trans_unit_id="131-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="f4dd06c4-c30b-4f6c-9a01-9d4b8d400f59"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="f4dd06c4-c30b-4f6c-9a01-9d4b8d400f59">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block> @SQL NVARCHAR(4000)
,@Columns NVARCHAR(4000)
,@GroupBy NVARCHAR(4000)
,@i INT = 1
,@nbr INT = 0
;
CREATE TABLE #Results
(
 [SalesTerritoryCountry] NVARCHAR(50)
,[SalesTerritoryRegion]  NVARCHAR(50)
,[TotalSalesAmount]      MONEY
)
WITH
(   DISTRIBUTION = ROUND_ROBIN
,   LOCATION = USER_DB
)
;</code_block>
        <fenced_code_lang>
DECLARE </fenced_code_lang>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="d3d57564-8c0e-45ec-9ba0-0fe22d8988d9"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="d3d57564-8c0e-45ec-9ba0-0fe22d8988d9">
        <Lines>
          <MarkdownLine>
            <LineId>c10506be-2e4e-4f4c-b0fe-c83690e24af8</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="132">
                <SegmentId>49c6a58d-1f5e-4457-8e6a-ea524ee16cf8</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="132"
                  trans_unit_id="132-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="133">
                <SegmentId>7d400fa1-f916-469d-b5a5-321d4f28f60f</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="133"
                  trans_unit_id="133-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="132">
            <SegmentId>49c6a58d-1f5e-4457-8e6a-ea524ee16cf8</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="132"
              trans_unit_id="132-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="133">
            <SegmentId>7d400fa1-f916-469d-b5a5-321d4f28f60f</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="133"
              trans_unit_id="133-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="01bef54b-d9d3-40df-ab82-ccd445b379f2"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="01bef54b-d9d3-40df-ab82-ccd445b379f2">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>SET @nbr =(SELECT MAX(Seq) FROM #Cube);

WHILE @i&lt;=@nbr
BEGIN
    SET @Columns = (SELECT Cols    FROM #Cube where seq = @i);
    SET @GroupBy = (SELECT GroupBy FROM #Cube where seq = @i);

    SET @SQL ='INSERT INTO #Results
              SELECT '+@Columns+'
              ,      SUM(SalesAmount) AS TotalSalesAmount
              FROM  dbo.factInternetSales s
              JOIN  dbo.DimSalesTerritory t  
              ON s.SalesTerritoryKey = t.SalesTerritoryKey
              '+CASE WHEN @GroupBy &lt;&gt;'' 
                     THEN 'GROUP BY '+@GroupBy ELSE '' END

    EXEC sp_executesql @SQL;
    SET @i +=1;
END</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="23266024-6c9b-4331-af91-4235e5780fb6"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="23266024-6c9b-4331-af91-4235e5780fb6">
        <Lines>
          <MarkdownLine>
            <LineId>ecf312d4-4311-4997-a7d7-1aae30d82221</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="134">
                <SegmentId>4d55e9ef-ca29-4421-874d-39c3611d73a9</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="134"
                  trans_unit_id="134-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="134">
            <SegmentId>4d55e9ef-ca29-4421-874d-39c3611d73a9</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="134"
              trans_unit_id="134-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="5972f760-f52a-4ad7-a233-af01d1be0e67"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="5972f760-f52a-4ad7-a233-af01d1be0e67">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>SELECT * 
FROM #Results
ORDER BY 1,2,3
;</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="dc97f733-8c92-4a91-824f-c94e4b9ac114"
        item_type="NormalParagraph"
        item_footer="&#xA;"
        trans_unit_id="dc97f733-8c92-4a91-824f-c94e4b9ac114">
        <Lines>
          <MarkdownLine>
            <LineId>ddc67eb8-0ec5-494e-86e2-fdcf5d99ee57</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="135">
                <SegmentId>b70a5788-d1db-435e-834a-5ac997c90d6c</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="135"
                  trans_unit_id="135-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="135">
            <SegmentId>b70a5788-d1db-435e-834a-5ac997c90d6c</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="135"
              trans_unit_id="135-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="cb7a282a-b5c1-4363-84d8-60b3f7ada0a4"
        item_type="Header"
        item_footer="footer_not_set"
        trans_unit_id="cb7a282a-b5c1-4363-84d8-60b3f7ada0a4">
        <segment
          trans_unit_id="136">
          <SegmentId>c58c06f3-e93c-40b1-816a-fce1f8e33854</SegmentId>
          <InternalNormalItem
            internal_item_id="1"
            internal_item_parent_id="136"
            trans_unit_id="136-1"
            internal_item_type="Normal">
            <internal_items />
          </InternalNormalItem>
        </segment>
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="b907c193-f344-44dd-bceb-42fafa341cf4"
        item_type="NormalParagraph"
        item_footer="&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;"
        trans_unit_id="b907c193-f344-44dd-bceb-42fafa341cf4">
        <Lines>
          <MarkdownLine>
            <LineId>fc315054-fb1f-4581-8577-1696b1226425</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="137">
                <SegmentId>d2bc0e7e-aefb-488e-bc30-20ecddd4abcb</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="137"
                  trans_unit_id="137-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
                <LinkItem
                  internal_item_id="2"
                  internal_item_parent_id="137"
                  trans_unit_id="137-2"
                  internal_item_type="Link">
                  <internal_items />
                  <internal_link_type>Reference</internal_link_type>
                  <internal_link_text>development overview</internal_link_text>
                  <internal_link_id />
                </LinkItem>
                <InternalNormalItem
                  internal_item_id="3"
                  internal_item_parent_id="137"
                  trans_unit_id="137-3"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="137">
            <SegmentId>d2bc0e7e-aefb-488e-bc30-20ecddd4abcb</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="137"
              trans_unit_id="137-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
            <LinkItem
              internal_item_id="2"
              internal_item_parent_id="137"
              trans_unit_id="137-2"
              internal_item_type="Link">
              <internal_items />
              <internal_link_type>Reference</internal_link_type>
              <internal_link_text>development overview</internal_link_text>
              <internal_link_id />
            </LinkItem>
            <InternalNormalItem
              internal_item_id="3"
              internal_item_parent_id="137"
              trans_unit_id="137-3"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
    </ArrayOfMarkdownBlockBase>
  </block_element>
  <references>
    <ArrayOfMarkdownLinkedReference xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <MarkdownLinkedReference
        item_id="23f3cc21-dc19-4c0c-97a1-dba143136daa"
        item_type="LinkedReference"
        item_footer="footer_not_set"
        trans_unit_id="23f3cc21-dc19-4c0c-97a1-dba143136daa">
        <link_id>1</link_id>
        <link_uri>media/sql-data-warehouse-develop-group-by-options/sql-data-warehouse-develop-group-by-cube.png</link_uri>
        <link_title />
      </MarkdownLinkedReference>
      <MarkdownLinkedReference
        item_id="b6e3fce5-6686-40bc-855e-fb49192b08a3"
        item_type="LinkedReference"
        item_footer="footer_not_set"
        trans_unit_id="b6e3fce5-6686-40bc-855e-fb49192b08a3">
        <link_id>development overview</link_id>
        <link_uri>sql-data-warehouse-overview-develop.md</link_uri>
        <link_title />
      </MarkdownLinkedReference>
      <MarkdownLinkedReference
        item_id="6ae2bf19-8f1a-4463-8cdb-1122fcc31ee0"
        item_type="LinkedReference"
        item_footer="footer_not_set"
        trans_unit_id="6ae2bf19-8f1a-4463-8cdb-1122fcc31ee0">
        <link_id>group by</link_id>
        <link_uri>https://msdn.microsoft.com/en-us/library/ms177673.aspx</link_uri>
        <link_title />
      </MarkdownLinkedReference>
    </ArrayOfMarkdownLinkedReference>
  </references>
</markdown_skeleton_root>