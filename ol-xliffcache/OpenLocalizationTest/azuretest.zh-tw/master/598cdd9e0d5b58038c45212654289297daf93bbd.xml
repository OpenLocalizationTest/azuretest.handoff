<markdown_skeleton_root>
  <block_element>
    <ArrayOfMarkdownBlockBase xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <MarkdownBlockBase
        xsi:type="MarkdownAzureMetadataBlock"
        item_id="c8fcf754-0535-4ca5-aedc-cef2300be8ed"
        item_type="AzureMetadata"
        item_footer="footer_not_set"
        trans_unit_id="c8fcf754-0535-4ca5-aedc-cef2300be8ed">
        <LocalizeItemList>
          <MarkdownInternalXmlItem
            internal_item_id="daa7cec4-e3ae-4335-bfd1-ee83387344db"
            trans_unit_id="101"
            internal_item_type="Xml">
            <internal_items />
          </MarkdownInternalXmlItem>
          <MarkdownInternalXmlItem
            internal_item_id="b1e22d09-efb1-40c3-a114-063290e4c3df"
            trans_unit_id="102"
            internal_item_type="Xml">
            <internal_items />
          </MarkdownInternalXmlItem>
        </LocalizeItemList>
        <ItemValue>&lt;properties
   pageTitle="daa7cec4-e3ae-4335-bfd1-ee83387344db"
   description="b1e22d09-efb1-40c3-a114-063290e4c3df"
   services="sql-data-warehouse"
   documentationCenter="NA"
   authors="jrowlandjones"
   manager="barbkess"
   editor=""/&gt;

&lt;tags
   ms.service="sql-data-warehouse"
   ms.devlang="NA"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="data-services"
   ms.date="06/22/2015"
   ms.author="JRJ@BigBangData.co.uk;barbkess"/&gt;

</ItemValue>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="7c976edb-c664-4fc5-a005-74abd7b4acd2"
        item_type="Header"
        item_footer="footer_not_set"
        trans_unit_id="7c976edb-c664-4fc5-a005-74abd7b4acd2">
        <segment
          trans_unit_id="103">
          <SegmentId>38bffa41-5f01-49f0-8957-245802b6565e</SegmentId>
          <InternalNormalItem
            internal_item_id="1"
            internal_item_parent_id="103"
            trans_unit_id="103-1"
            internal_item_type="Normal">
            <internal_items />
          </InternalNormalItem>
        </segment>
        <header_type>Star</header_type>
        <header_level>1</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="22b51ab5-8ba1-4efd-836e-801711c1412c"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="22b51ab5-8ba1-4efd-836e-801711c1412c">
        <Lines>
          <MarkdownLine>
            <LineId>6a59bfc4-5fc8-4c66-a4d9-e1fe24397f07</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="104">
                <SegmentId>ed6e43f8-b145-4030-92ca-3f4410d60d04</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="104"
                  trans_unit_id="104-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="105">
                <SegmentId>69354375-f7b0-46d9-b986-17c4742a3166</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="105"
                  trans_unit_id="105-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="104">
            <SegmentId>ed6e43f8-b145-4030-92ca-3f4410d60d04</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="104"
              trans_unit_id="104-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="105">
            <SegmentId>69354375-f7b0-46d9-b986-17c4742a3166</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="105"
              trans_unit_id="105-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="5229bc4d-8edd-4f28-9f85-8d0959d83c74"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="5229bc4d-8edd-4f28-9f85-8d0959d83c74">
        <Lines>
          <MarkdownLine>
            <LineId>e46702ca-0f4f-4115-a040-bdfc25d6d8d0</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="106">
                <SegmentId>28451c1b-4eaf-429e-a2de-6872707a4433</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="106"
                  trans_unit_id="106-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="106">
            <SegmentId>28451c1b-4eaf-429e-a2de-6872707a4433</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="106"
              trans_unit_id="106-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="a6e90d45-0203-4fbb-a2f4-9491f1f79c79"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="a6e90d45-0203-4fbb-a2f4-9491f1f79c79">
        <Lines>
          <MarkdownLine>
            <LineId>af85454f-de39-4cf3-a677-22a93f2ff405</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="107">
                <SegmentId>645fdfd7-5fc6-4304-aa8c-4315ea26b303</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="107"
                  trans_unit_id="107-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="107">
            <SegmentId>645fdfd7-5fc6-4304-aa8c-4315ea26b303</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="107"
              trans_unit_id="107-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="48d960b6-88ba-4593-ae65-6fbb1a83ca69"
        item_type="Header"
        item_footer="footer_not_set"
        trans_unit_id="48d960b6-88ba-4593-ae65-6fbb1a83ca69">
        <segment
          trans_unit_id="108">
          <SegmentId>5b7dc472-1673-49fa-9d8a-a9337d1ec832</SegmentId>
          <InternalNormalItem
            internal_item_id="1"
            internal_item_parent_id="108"
            trans_unit_id="108-1"
            internal_item_type="Normal">
            <internal_items />
          </InternalNormalItem>
        </segment>
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="ab1b9f48-ecf3-4d0b-b91c-e7c099fa841e"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="ab1b9f48-ecf3-4d0b-b91c-e7c099fa841e">
        <Lines>
          <MarkdownLine>
            <LineId>10345c8e-fdff-4ef3-a129-b6359a693361</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="109">
                <SegmentId>a61617c3-4941-4d4e-a955-79314a166497</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="109"
                  trans_unit_id="109-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="109">
            <SegmentId>a61617c3-4941-4d4e-a955-79314a166497</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="109"
              trans_unit_id="109-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="8eaabe7a-795c-4345-bdf0-b78aeea0da16"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="8eaabe7a-795c-4345-bdf0-b78aeea0da16">
        <Lines>
          <MarkdownLine>
            <LineId>4b9b5e01-3427-4f0a-8881-bc5657925cb5</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="110">
                <SegmentId>84f0a147-6642-4eaa-bbfc-044cc8703ea1</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="110"
                  trans_unit_id="110-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="110">
            <SegmentId>84f0a147-6642-4eaa-bbfc-044cc8703ea1</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="110"
              trans_unit_id="110-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="c7876f2e-3f29-4942-a5d6-6c462b47428c"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="c7876f2e-3f29-4942-a5d6-6c462b47428c">
        <Lines>
          <MarkdownLine>
            <LineId>207263ef-424a-42b4-a5bd-1a5650e9db2c</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="111">
                <SegmentId>462dd330-1861-4ff0-8158-803b130ab557</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="111"
                  trans_unit_id="111-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="111">
            <SegmentId>462dd330-1861-4ff0-8158-803b130ab557</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="111"
              trans_unit_id="111-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="8b2ec4c6-5bd4-412f-8d9d-5c0ece70414b"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="8b2ec4c6-5bd4-412f-8d9d-5c0ece70414b">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>CREATE PROCEDURE    [dbo].[prc_sqldw_update_stats]
(   @update_type    tinyint -- 1 default 2 fullscan 3 sample 4 resample
,   @sample_pct     tinyint
)
AS

IF @update_type NOT IN (1,2,3,4)
BEGIN;
    THROW 151000,'Invalid value for @update_type parameter. Valid range 1 (default), 2 (fullscan), 3 (sample) or 4 (resample).',1;
END;

IF @sample_pct IS NULL
BEGIN;
    SET @sample_pct = 20;
END;

CREATE TABLE #stats_ddl
WITH    (   DISTRIBUTION = HASH([seq_nmbr])
        ,   LOCATION     = USER_DB
        )
WITH t1
AS
(
SELECT
        sm.[name]                                                               AS [schema_name]
,       tb.[name]                                                               AS [table_name]
,       st.[name]                                                               AS [stats_name]
,       st.[has_filter]                                                         AS [stats_is_filtered]
,       ROW_NUMBER()
        OVER(ORDER BY (SELECT NULL))                                            AS [seq_nmbr]
,                                QUOTENAME(sm.[name])+'.'+QUOTENAME(tb.[name])  AS [two_part_name]
,       QUOTENAME(DB_NAME())+'.'+QUOTENAME(sm.[name])+'.'+QUOTENAME(tb.[name])  AS [three_part_name]
FROM    sys.objects         AS ob
JOIN    sys.stats           AS st   ON  ob.[object_id]      = st.[object_id]
JOIN    sys.stats_columns   AS sc   ON  st.[stats_id]       = sc.[stats_id]
                                    AND st.[object_id]      = sc.[object_id]
JOIN    sys.columns         AS co   ON  sc.[column_id]      = co.[column_id]
                                    AND sc.[object_id]      = co.[object_id]
JOIN    sys.tables          AS tb   ON  co.[object_id]      = tb.[object_id]
JOIN    sys.schemas         AS sm   ON  tb.[schema_id]      = sm.[schema_id]
WHERE   1=1
AND     st.[user_created]   = 1
GROUP BY
        sm.[name]
,       tb.[name]
,       st.[name]
,       st.[filter_definition]
,       st.[has_filter]
)
SELECT
    CASE @update_type
    WHEN 1
    THEN 'UPDATE STATISTICS '+[two_part_name]+'('+[stats_name]+');'
    WHEN 2
    THEN 'UPDATE STATISTICS '+[two_part_name]+'('+[stats_name]+') WITH FULLSCAN;'
    WHEN 3
    THEN 'UPDATE STATISTICS '+[two_part_name]+'('+[stats_name]+') WITH SAMPLE '+CAST(@sample_pct AS VARCHAR(20))+' PERCENT;'
    WHEN 4
    THEN 'UPDATE STATISTICS '+[two_part_name]+'('+[stats_name]+') WITH RESAMPLE;'
    END AS [update_stats_ddl]
,   [seq_nmbr]
FROM    t1
;</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="8d5d7c2e-434b-4cc1-9016-8049bf1fb573"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="8d5d7c2e-434b-4cc1-9016-8049bf1fb573">
        <Lines>
          <MarkdownLine>
            <LineId>11eac313-25df-4156-8f8d-667df494dbd3</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="112">
                <SegmentId>e459a2e7-f270-4c09-a046-073bf64b5e48</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="112"
                  trans_unit_id="112-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="113">
                <SegmentId>f8be1366-a219-45c1-a68e-76580cff4ba5</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="113"
                  trans_unit_id="113-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="112">
            <SegmentId>e459a2e7-f270-4c09-a046-073bf64b5e48</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="112"
              trans_unit_id="112-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="113">
            <SegmentId>f8be1366-a219-45c1-a68e-76580cff4ba5</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="113"
              trans_unit_id="113-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="fc930033-d15c-410c-9fce-236f23ff8a53"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="fc930033-d15c-410c-9fce-236f23ff8a53">
        <Lines>
          <MarkdownLine>
            <LineId>b094dead-abe8-4cde-a6b7-9ef58084ba4b</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="114">
                <SegmentId>7386f569-f385-4d7d-a34b-b428acac8f5a</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="114"
                  trans_unit_id="114-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="115">
                <SegmentId>436e66de-1a93-4741-8e6e-9278630ce3c9</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="115"
                  trans_unit_id="115-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="116">
                <SegmentId>56180f30-0087-4721-a79f-71bdc87fbbfb</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="116"
                  trans_unit_id="116-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
                <MarkdownInternalBoldItem
                  internal_item_id="2"
                  internal_item_parent_id="116"
                  trans_unit_id="116-2"
                  internal_item_type="Bold">
                  <internal_items />
                  <internal_itatic_bold_item_type>Star</internal_itatic_bold_item_type>
                </MarkdownInternalBoldItem>
                <InternalNormalItem
                  internal_item_id="3"
                  internal_item_parent_id="116"
                  trans_unit_id="116-3"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="114">
            <SegmentId>7386f569-f385-4d7d-a34b-b428acac8f5a</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="114"
              trans_unit_id="114-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="115">
            <SegmentId>436e66de-1a93-4741-8e6e-9278630ce3c9</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="115"
              trans_unit_id="115-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="116">
            <SegmentId>56180f30-0087-4721-a79f-71bdc87fbbfb</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="116"
              trans_unit_id="116-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
            <MarkdownInternalBoldItem
              internal_item_id="2"
              internal_item_parent_id="116"
              trans_unit_id="116-2"
              internal_item_type="Bold">
              <internal_items />
              <internal_itatic_bold_item_type>Star</internal_itatic_bold_item_type>
            </MarkdownInternalBoldItem>
            <InternalNormalItem
              internal_item_id="3"
              internal_item_parent_id="116"
              trans_unit_id="116-3"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="3e10e16a-ee31-4a09-8121-29e41d6e7664"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="3e10e16a-ee31-4a09-8121-29e41d6e7664">
        <Lines>
          <MarkdownLine>
            <LineId>d796f460-2b6b-4baf-b516-65e230a53da0</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="117">
                <SegmentId>1197ac44-5641-4ea3-8f1b-5d8ce97f27ed</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="117"
                  trans_unit_id="117-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="117">
            <SegmentId>1197ac44-5641-4ea3-8f1b-5d8ce97f27ed</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="117"
              trans_unit_id="117-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="b37ea5c0-0a6c-4d26-ae80-a10ed80e5e79"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="b37ea5c0-0a6c-4d26-ae80-a10ed80e5e79">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>EXEC [dbo].[prc_sqldw_update_stats] @update_type = 1, @sample_pct = NULL;

DECLARE @i INT              = 1
,       @t INT              = (SELECT COUNT(*) FROM #stats_ddl)
,       @s NVARCHAR(4000)   = N''

WHILE @i &lt;= @t
BEGIN
    SET @s=(SELECT update_stats_ddl FROM #stats_ddl WHERE seq_nmbr = @i);

    PRINT @s
    EXEC sp_executesql @s
    SET @i+=1;
END

DROP TABLE #stats_ddl;</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="1fee244a-fe68-4f4f-928e-bb0ce96ee741"
        item_type="NormalParagraph"
        item_footer="footer_not_set"
        trans_unit_id="1fee244a-fe68-4f4f-928e-bb0ce96ee741">
        <Lines>
          <MarkdownLine>
            <LineId>c2768fc0-c13d-45a5-b2c3-068e891e1087</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="118">
                <SegmentId>db16247f-532f-4dd6-9881-fbed5965312c</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="118"
                  trans_unit_id="118-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="118">
            <SegmentId>db16247f-532f-4dd6-9881-fbed5965312c</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="118"
              trans_unit_id="118-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownNoteBlock"
        item_id="41513d50-4e26-4bac-a0ee-3f31b23332c8"
        item_type="Note"
        item_footer=""
        trans_unit_id="41513d50-4e26-4bac-a0ee-3f31b23332c8">
        <Lines>
          <MarkdownLine>
            <LineId>af892b5d-ed20-400d-9508-05a58afb4770</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="119">
                <SegmentId>59e53c7c-0b09-488f-b09e-779c39e92380</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="119"
                  trans_unit_id="119-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="120">
                <SegmentId>8d8c5a62-ba4b-4f65-91b0-d677b7fb983f</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="120"
                  trans_unit_id="120-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <NoteSign>&gt; [AZURE.NOTE] </NoteSign>
        <Prefixes>
          <string />
        </Prefixes>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="119">
            <SegmentId>59e53c7c-0b09-488f-b09e-779c39e92380</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="119"
              trans_unit_id="119-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="120">
            <SegmentId>8d8c5a62-ba4b-4f65-91b0-d677b7fb983f</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="120"
              trans_unit_id="120-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="982d393c-1c58-4681-98e5-be2b150e6b10"
        item_type="Header"
        item_footer="footer_not_set"
        trans_unit_id="982d393c-1c58-4681-98e5-be2b150e6b10">
        <segment
          trans_unit_id="121">
          <SegmentId>582580f4-33b2-462d-b083-591311de61c4</SegmentId>
          <InternalNormalItem
            internal_item_id="1"
            internal_item_parent_id="121"
            trans_unit_id="121-1"
            internal_item_type="Normal">
            <internal_items />
          </InternalNormalItem>
        </segment>
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="2ce4ebbc-207c-4c5d-866b-c092089d1bd9"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="2ce4ebbc-207c-4c5d-866b-c092089d1bd9">
        <Lines>
          <MarkdownLine>
            <LineId>dbb97679-c862-4bea-a185-73a99605fb8a</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="122">
                <SegmentId>b59dae58-7c5a-4394-94b8-672a4135880d</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="122"
                  trans_unit_id="122-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="122">
            <SegmentId>b59dae58-7c5a-4394-94b8-672a4135880d</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="122"
              trans_unit_id="122-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="419e2b08-eea5-461f-929c-9e2b891e3c30"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="419e2b08-eea5-461f-929c-9e2b891e3c30">
        <Lines>
          <MarkdownLine>
            <LineId>e71d4361-23ce-4bc2-95e0-ff1b0a8a5d4f</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="123">
                <SegmentId>17a59100-4a42-4b0e-91a9-e1e0f261f0e2</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="123"
                  trans_unit_id="123-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="123">
            <SegmentId>17a59100-4a42-4b0e-91a9-e1e0f261f0e2</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="123"
              trans_unit_id="123-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownListBlock"
        item_id="d2b8be4f-f223-4dfd-84cb-850ea5d937db"
        item_type="List"
        item_footer="&#xA;"
        trans_unit_id="d2b8be4f-f223-4dfd-84cb-850ea5d937db">
        <inner_list_items>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="0c4fcd09-13aa-4a37-a57d-06993f0fa3ac"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="0c4fcd09-13aa-4a37-a57d-06993f0fa3ac">
              <Lines>
                <MarkdownLine>
                  <LineId>c5b89212-86ca-40a9-9fac-361e0628a990</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="124">
                      <SegmentId>6ba25ba2-462b-423b-b3e8-241c7cdf36b3</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="124"
                        trans_unit_id="124-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="124">
                  <SegmentId>6ba25ba2-462b-423b-b3e8-241c7cdf36b3</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="124"
                    trans_unit_id="124-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="b8d5abae-b646-47b3-ab63-df990674304b"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="b8d5abae-b646-47b3-ab63-df990674304b">
              <Lines>
                <MarkdownLine>
                  <LineId>8610b1a5-e035-4001-963c-e2217cbfcd81</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="125">
                      <SegmentId>4d807628-743b-4d2b-b0a8-1f5ed75961c1</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="125"
                        trans_unit_id="125-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="125">
                  <SegmentId>4d807628-743b-4d2b-b0a8-1f5ed75961c1</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="125"
                    trans_unit_id="125-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
        </inner_list_items>
        <ListType>Charactor</ListType>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="82b0e372-235f-49ce-8762-d813a3f3313c"
        item_type="Header"
        item_footer="footer_not_set"
        trans_unit_id="82b0e372-235f-49ce-8762-d813a3f3313c">
        <segment
          trans_unit_id="126">
          <SegmentId>b2b1d055-d061-4c91-89bf-1a8868eee188</SegmentId>
          <InternalNormalItem
            internal_item_id="1"
            internal_item_parent_id="126"
            trans_unit_id="126-1"
            internal_item_type="Normal">
            <internal_items />
          </InternalNormalItem>
        </segment>
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="62d2d562-ea36-48a9-be11-bd3908314c58"
        item_type="NormalParagraph"
        item_footer="&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;"
        trans_unit_id="62d2d562-ea36-48a9-be11-bd3908314c58">
        <Lines>
          <MarkdownLine>
            <LineId>eb4aa814-d313-4ae1-9bca-0f7035acd5f2</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="127">
                <SegmentId>6ce91a28-d803-4ec5-80f7-17af6c0cb94f</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="127"
                  trans_unit_id="127-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
                <LinkItem
                  internal_item_id="2"
                  internal_item_parent_id="127"
                  trans_unit_id="127-2"
                  internal_item_type="Link">
                  <internal_items />
                  <internal_link_type>Reference</internal_link_type>
                  <internal_link_text>development overview</internal_link_text>
                  <internal_link_id />
                </LinkItem>
                <InternalNormalItem
                  internal_item_id="3"
                  internal_item_parent_id="127"
                  trans_unit_id="127-3"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="127">
            <SegmentId>6ce91a28-d803-4ec5-80f7-17af6c0cb94f</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="127"
              trans_unit_id="127-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
            <LinkItem
              internal_item_id="2"
              internal_item_parent_id="127"
              trans_unit_id="127-2"
              internal_item_type="Link">
              <internal_items />
              <internal_link_type>Reference</internal_link_type>
              <internal_link_text>development overview</internal_link_text>
              <internal_link_id />
            </LinkItem>
            <InternalNormalItem
              internal_item_id="3"
              internal_item_parent_id="127"
              trans_unit_id="127-3"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
    </ArrayOfMarkdownBlockBase>
  </block_element>
  <references>
    <ArrayOfMarkdownLinkedReference xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <MarkdownLinkedReference
        item_id="9ef09301-66d7-40b8-b6ec-1029b12e9eaf"
        item_type="LinkedReference"
        item_footer="footer_not_set"
        trans_unit_id="9ef09301-66d7-40b8-b6ec-1029b12e9eaf">
        <link_id>development overview</link_id>
        <link_uri>sql-data-warehouse-overview-develop.md</link_uri>
        <link_title />
      </MarkdownLinkedReference>
    </ArrayOfMarkdownLinkedReference>
  </references>
</markdown_skeleton_root>