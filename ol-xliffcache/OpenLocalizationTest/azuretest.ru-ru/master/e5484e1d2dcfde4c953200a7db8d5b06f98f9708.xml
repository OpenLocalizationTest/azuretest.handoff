<markdown_skeleton_root>
  <block_element>
    <ArrayOfMarkdownBlockBase xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <MarkdownBlockBase
        xsi:type="MarkdownAzureMetadataBlock"
        item_id="8c107bc5-f2d9-4cec-9399-38bf8cc961d9"
        item_type="AzureMetadata"
        item_footer="footer_not_set"
        trans_unit_id="8c107bc5-f2d9-4cec-9399-38bf8cc961d9">
        <LocalizeItemList>
          <MarkdownInternalXmlItem
            internal_item_id="e82e1f3a-f1c1-4ec1-a3b8-4383fb4f0ef4"
            trans_unit_id="101"
            internal_item_type="Xml">
            <internal_items />
          </MarkdownInternalXmlItem>
          <MarkdownInternalXmlItem
            internal_item_id="1082b904-4d5c-4137-b2f6-ac8d1d5a68fa"
            trans_unit_id="102"
            internal_item_type="Xml">
            <internal_items />
          </MarkdownInternalXmlItem>
        </LocalizeItemList>
        <ItemValue>&lt;properties
   pageTitle="e82e1f3a-f1c1-4ec1-a3b8-4383fb4f0ef4"
   description="1082b904-4d5c-4137-b2f6-ac8d1d5a68fa"
   services="sql-data-warehouse"
   documentationCenter="NA"
   authors="jrowlandjones"
   manager="barbkess"
   editor=""/&gt;

&lt;tags
   ms.service="sql-data-warehouse"
   ms.devlang="NA"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="data-services"
   ms.date="06/26/2015"
   ms.author="JRJ@BigBangData.co.uk;barbkess"/&gt;

</ItemValue>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="dca5868d-7bc3-4b15-aabd-6ee8c049960f"
        item_type="Header"
        item_footer="footer_not_set"
        trans_unit_id="dca5868d-7bc3-4b15-aabd-6ee8c049960f">
        <segment
          trans_unit_id="103">
          <SegmentId>c4cb6c18-a1bf-4544-b9ad-fcc0cd5701e2</SegmentId>
          <InternalNormalItem
            internal_item_id="1"
            internal_item_parent_id="103"
            trans_unit_id="103-1"
            internal_item_type="Normal">
            <internal_items />
          </InternalNormalItem>
        </segment>
        <header_type>Star</header_type>
        <header_level>1</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="59cf3a98-4edd-4c90-836d-903932ac4240"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="59cf3a98-4edd-4c90-836d-903932ac4240">
        <Lines>
          <MarkdownLine>
            <LineId>30ca3a03-50a8-490e-a3a6-6dcae06a4f7a</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="104">
                <SegmentId>ed575f23-063b-4bc8-88f9-8da0a6ba4a2e</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="104"
                  trans_unit_id="104-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="105">
                <SegmentId>5a954a72-f491-4dbc-921b-0b81d465ab4c</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="105"
                  trans_unit_id="105-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="104">
            <SegmentId>ed575f23-063b-4bc8-88f9-8da0a6ba4a2e</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="104"
              trans_unit_id="104-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="105">
            <SegmentId>5a954a72-f491-4dbc-921b-0b81d465ab4c</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="105"
              trans_unit_id="105-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="fbf3c79d-65b3-4ea2-bab0-b6d9c0fd4527"
        item_type="NormalParagraph"
        item_footer="footer_not_set"
        trans_unit_id="fbf3c79d-65b3-4ea2-bab0-b6d9c0fd4527">
        <Lines>
          <MarkdownLine>
            <LineId>57941785-4e56-4d4b-a621-f47041a249e4</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="106">
                <SegmentId>a5661dae-66d7-4c5e-8732-1b39c8cbe416</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="106"
                  trans_unit_id="106-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="106">
            <SegmentId>a5661dae-66d7-4c5e-8732-1b39c8cbe416</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="106"
              trans_unit_id="106-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownListBlock"
        item_id="22144c59-450d-478e-b6b4-d1d28a57df13"
        item_type="List"
        item_footer=""
        trans_unit_id="22144c59-450d-478e-b6b4-d1d28a57df13">
        <inner_list_items>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="0b625b61-ee45-45b6-ba62-3a61bf55fca5"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="0b625b61-ee45-45b6-ba62-3a61bf55fca5">
              <Lines>
                <MarkdownLine>
                  <LineId>6e22c337-64df-4e22-9f9f-2913e1a12457</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="107">
                      <SegmentId>82bb3754-5a23-4767-b4ac-1b5aef1be092</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="107"
                        trans_unit_id="107-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="107">
                  <SegmentId>82bb3754-5a23-4767-b4ac-1b5aef1be092</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="107"
                    trans_unit_id="107-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="2d91e9ef-fa8c-4f2d-addf-958de3634a85"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="2d91e9ef-fa8c-4f2d-addf-958de3634a85">
              <Lines>
                <MarkdownLine>
                  <LineId>532979bc-f7e0-4fd2-830f-7e3c1dd5426c</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="108">
                      <SegmentId>6776b7cb-3fef-4508-854b-96cfea26f521</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="108"
                        trans_unit_id="108-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="108">
                  <SegmentId>6776b7cb-3fef-4508-854b-96cfea26f521</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="108"
                    trans_unit_id="108-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="c007bce9-d806-4ed0-ad20-b20fdc379a02"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="c007bce9-d806-4ed0-ad20-b20fdc379a02">
              <Lines>
                <MarkdownLine>
                  <LineId>d8d6301a-de50-457a-bba0-f1f0231ad1b3</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="109">
                      <SegmentId>cdc2b9cf-2d20-4013-b473-b5bca22ebfad</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="109"
                        trans_unit_id="109-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="109">
                  <SegmentId>cdc2b9cf-2d20-4013-b473-b5bca22ebfad</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="109"
                    trans_unit_id="109-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
        </inner_list_items>
        <ListType>Charactor</ListType>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="480295f8-b99d-4ebd-ae18-aa5ed1cdb5d9"
        item_type="Header"
        item_footer="footer_not_set"
        trans_unit_id="480295f8-b99d-4ebd-ae18-aa5ed1cdb5d9">
        <segment
          trans_unit_id="110">
          <SegmentId>ac800e51-c000-4b49-848a-3366b186a394</SegmentId>
          <InternalNormalItem
            internal_item_id="1"
            internal_item_parent_id="110"
            trans_unit_id="110-1"
            internal_item_type="Normal">
            <internal_items />
          </InternalNormalItem>
        </segment>
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="b15cae3c-972e-4547-a34d-46c27664ccd9"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="b15cae3c-972e-4547-a34d-46c27664ccd9">
        <Lines>
          <MarkdownLine>
            <LineId>8a5192bb-7d51-4b69-b76c-32269ba961b5</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="111">
                <SegmentId>bb26c451-b4a5-4297-ab28-ce3d4bcf6e52</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="111"
                  trans_unit_id="111-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
                <CodeSpanItem
                  internal_item_id="2"
                  internal_item_parent_id="111"
                  trans_unit_id="111-2"
                  internal_item_type="CodeSpan">
                  <internal_items />
                  <ItemValue>UNION ALL</ItemValue>
                </CodeSpanItem>
                <InternalNormalItem
                  internal_item_id="3"
                  internal_item_parent_id="111"
                  trans_unit_id="111-3"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="112">
                <SegmentId>faed3c45-4c84-4004-9b87-7d849cc21508</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="112"
                  trans_unit_id="112-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="111">
            <SegmentId>bb26c451-b4a5-4297-ab28-ce3d4bcf6e52</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="111"
              trans_unit_id="111-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
            <CodeSpanItem
              internal_item_id="2"
              internal_item_parent_id="111"
              trans_unit_id="111-2"
              internal_item_type="CodeSpan">
              <internal_items />
              <ItemValue>UNION ALL</ItemValue>
            </CodeSpanItem>
            <InternalNormalItem
              internal_item_id="3"
              internal_item_parent_id="111"
              trans_unit_id="111-3"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="112">
            <SegmentId>faed3c45-4c84-4004-9b87-7d849cc21508</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="112"
              trans_unit_id="112-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="6e7a7917-7150-4bbd-a3c8-1f36151691da"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="6e7a7917-7150-4bbd-a3c8-1f36151691da">
        <Lines>
          <MarkdownLine>
            <LineId>1c1a6467-9c19-499c-8e70-c945f67cc19c</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="113">
                <SegmentId>3f98fe8c-5968-4e31-b268-fdf3c60548ce</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="113"
                  trans_unit_id="113-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
                <CodeSpanItem
                  internal_item_id="2"
                  internal_item_parent_id="113"
                  trans_unit_id="113-2"
                  internal_item_type="CodeSpan">
                  <internal_items />
                  <ItemValue>ROLLUP</ItemValue>
                </CodeSpanItem>
                <InternalNormalItem
                  internal_item_id="3"
                  internal_item_parent_id="113"
                  trans_unit_id="113-3"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="113">
            <SegmentId>3f98fe8c-5968-4e31-b268-fdf3c60548ce</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="113"
              trans_unit_id="113-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
            <CodeSpanItem
              internal_item_id="2"
              internal_item_parent_id="113"
              trans_unit_id="113-2"
              internal_item_type="CodeSpan">
              <internal_items />
              <ItemValue>ROLLUP</ItemValue>
            </CodeSpanItem>
            <InternalNormalItem
              internal_item_id="3"
              internal_item_parent_id="113"
              trans_unit_id="113-3"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="597cf4f0-2760-4d0c-82ee-f110b05d5f2c"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="597cf4f0-2760-4d0c-82ee-f110b05d5f2c">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>SELECT [SalesTerritoryCountry]
,      [SalesTerritoryRegion]
,      SUM(SalesAmount)             AS TotalSalesAmount
FROM  dbo.factInternetSales s
JOIN  dbo.DimSalesTerritory t       ON s.SalesTerritoryKey       = t.SalesTerritoryKey
GROUP BY ROLLUP (
                        [SalesTerritoryCountry]
                ,       [SalesTerritoryRegion]
                )
;</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="ad876446-7c54-4324-acd3-67878815466a"
        item_type="NormalParagraph"
        item_footer="footer_not_set"
        trans_unit_id="ad876446-7c54-4324-acd3-67878815466a">
        <Lines>
          <MarkdownLine>
            <LineId>435ed67f-103f-4181-b19a-ad6a516ad656</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="114">
                <SegmentId>01438e6c-af26-491c-948a-2d3a1df79d30</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="114"
                  trans_unit_id="114-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="114">
            <SegmentId>01438e6c-af26-491c-948a-2d3a1df79d30</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="114"
              trans_unit_id="114-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownListBlock"
        item_id="f4cc6e40-58a4-4d0f-abbb-6a4a48eaa2c1"
        item_type="List"
        item_footer=""
        trans_unit_id="f4cc6e40-58a4-4d0f-abbb-6a4a48eaa2c1">
        <inner_list_items>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="226830b4-45c0-40b3-b6f0-6b5fe4759581"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="226830b4-45c0-40b3-b6f0-6b5fe4759581">
              <Lines>
                <MarkdownLine>
                  <LineId>e1243e5c-8e4c-45b2-88f1-3d8dd02d4ffa</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="115">
                      <SegmentId>946f163f-6074-4a49-95f9-43dbb760977d</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="115"
                        trans_unit_id="115-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="115">
                  <SegmentId>946f163f-6074-4a49-95f9-43dbb760977d</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="115"
                    trans_unit_id="115-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="ec1eb16c-0083-403d-9c24-007278937a58"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="ec1eb16c-0083-403d-9c24-007278937a58">
              <Lines>
                <MarkdownLine>
                  <LineId>8495bb8d-7a7a-45a2-be18-ca4d1a75a3ed</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="116">
                      <SegmentId>45b22130-f7cc-470e-b2fe-9b0c9df53d69</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="116"
                        trans_unit_id="116-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="116">
                  <SegmentId>45b22130-f7cc-470e-b2fe-9b0c9df53d69</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="116"
                    trans_unit_id="116-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="e484b22e-6472-4594-b7a5-1b10927b2940"
              item_type="NormalParagraph"
              item_footer="footer_not_set"
              trans_unit_id="e484b22e-6472-4594-b7a5-1b10927b2940">
              <Lines>
                <MarkdownLine>
                  <LineId>c5c9e4d4-81bd-4644-b648-34406d1587e4</LineId>
                  <paragraph_segments>
                    <MarkdownSegment
                      trans_unit_id="117">
                      <SegmentId>66bdeffb-148a-47ee-98e1-769cacfbc01e</SegmentId>
                      <InternalNormalItem
                        internal_item_id="1"
                        internal_item_parent_id="117"
                        trans_unit_id="117-1"
                        internal_item_type="Normal">
                        <internal_items />
                      </InternalNormalItem>
                    </MarkdownSegment>
                  </paragraph_segments>
                  <PrefixWSLength>1</PrefixWSLength>
                  <SuffixWSLength>0</SuffixWSLength>
                </MarkdownLine>
              </Lines>
              <paragraph_segments>
                <MarkdownSegment
                  trans_unit_id="117">
                  <SegmentId>66bdeffb-148a-47ee-98e1-769cacfbc01e</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1"
                    internal_item_parent_id="117"
                    trans_unit_id="117-1"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>-</Identifier>
            <IndentsLength>
              <int>0</int>
            </IndentsLength>
          </ListItem>
        </inner_list_items>
        <ListType>Charactor</ListType>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="2f4aa1d7-843d-449d-ad3f-bc36b930118a"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="2f4aa1d7-843d-449d-ad3f-bc36b930118a">
        <Lines>
          <MarkdownLine>
            <LineId>005fe86c-afb0-47b5-9a67-29e697027904</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="118">
                <SegmentId>159c7cb2-df18-45fb-847c-9765b6679a15</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="118"
                  trans_unit_id="118-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
                <CodeSpanItem
                  internal_item_id="2"
                  internal_item_parent_id="118"
                  trans_unit_id="118-2"
                  internal_item_type="CodeSpan">
                  <internal_items />
                  <ItemValue>UNION ALL</ItemValue>
                </CodeSpanItem>
                <InternalNormalItem
                  internal_item_id="3"
                  internal_item_parent_id="118"
                  trans_unit_id="118-3"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="118">
            <SegmentId>159c7cb2-df18-45fb-847c-9765b6679a15</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="118"
              trans_unit_id="118-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
            <CodeSpanItem
              internal_item_id="2"
              internal_item_parent_id="118"
              trans_unit_id="118-2"
              internal_item_type="CodeSpan">
              <internal_items />
              <ItemValue>UNION ALL</ItemValue>
            </CodeSpanItem>
            <InternalNormalItem
              internal_item_id="3"
              internal_item_parent_id="118"
              trans_unit_id="118-3"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="12c183ac-c982-45e6-b53a-5e94239e0cc3"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="12c183ac-c982-45e6-b53a-5e94239e0cc3">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>SELECT [SalesTerritoryCountry]
,      [SalesTerritoryRegion]
,      SUM(SalesAmount) AS TotalSalesAmount
FROM  dbo.factInternetSales s
JOIN  dbo.DimSalesTerritory t     ON s.SalesTerritoryKey       = t.SalesTerritoryKey
GROUP BY 
       [SalesTerritoryCountry]
,      [SalesTerritoryRegion]
UNION ALL
SELECT [SalesTerritoryCountry]
,      NULL
,      SUM(SalesAmount) AS TotalSalesAmount
FROM  dbo.factInternetSales s
JOIN  dbo.DimSalesTerritory t     ON s.SalesTerritoryKey       = t.SalesTerritoryKey
GROUP BY 
       [SalesTerritoryCountry]
UNION ALL
SELECT NULL
,      NULL
,      SUM(SalesAmount) AS TotalSalesAmount
FROM  dbo.factInternetSales s
JOIN  dbo.DimSalesTerritory t     ON s.SalesTerritoryKey       = t.SalesTerritoryKey;</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="d4befcf7-16c9-4b68-92b5-aabd85f32b99"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="d4befcf7-16c9-4b68-92b5-aabd85f32b99">
        <Lines>
          <MarkdownLine>
            <LineId>b1e66d84-f020-409f-806c-dd6c73976590</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="119">
                <SegmentId>49c18e46-081c-43d2-bb9a-bb0318c2ab0a</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="119"
                  trans_unit_id="119-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="119">
            <SegmentId>49c18e46-081c-43d2-bb9a-bb0318c2ab0a</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="119"
              trans_unit_id="119-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="b6a54fbc-d6d3-4ee1-b88b-b71ea0a1584d"
        item_type="Header"
        item_footer="footer_not_set"
        trans_unit_id="b6a54fbc-d6d3-4ee1-b88b-b71ea0a1584d">
        <segment
          trans_unit_id="120">
          <SegmentId>a8c01aec-5a5e-47f8-913c-e61763d046f4</SegmentId>
          <InternalNormalItem
            internal_item_id="1"
            internal_item_parent_id="120"
            trans_unit_id="120-1"
            internal_item_type="Normal">
            <internal_items />
          </InternalNormalItem>
        </segment>
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="f653c4c0-ec34-4d4a-aefe-20c1b1ba305d"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="f653c4c0-ec34-4d4a-aefe-20c1b1ba305d">
        <Lines>
          <MarkdownLine>
            <LineId>73e258a2-dc58-4bc7-928b-897464976fa8</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="121">
                <SegmentId>0ec9ebeb-631b-43b2-8b3c-d3959356b8f0</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="121"
                  trans_unit_id="121-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="122">
                <SegmentId>0be4c4d4-e07b-4db0-abac-86c3489aa8a7</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="122"
                  trans_unit_id="122-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="123">
                <SegmentId>9ab0a593-733a-4681-af99-c921fa11b156</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="123"
                  trans_unit_id="123-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="121">
            <SegmentId>0ec9ebeb-631b-43b2-8b3c-d3959356b8f0</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="121"
              trans_unit_id="121-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="122">
            <SegmentId>0be4c4d4-e07b-4db0-abac-86c3489aa8a7</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="122"
              trans_unit_id="122-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="123">
            <SegmentId>9ab0a593-733a-4681-af99-c921fa11b156</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="123"
              trans_unit_id="123-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="973338bb-39ba-4bdc-aad5-d059fb2b1b95"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="973338bb-39ba-4bdc-aad5-d059fb2b1b95">
        <Lines>
          <MarkdownLine>
            <LineId>4cdab983-b3bf-433a-9f24-fcdb99f3ba43</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="124">
                <SegmentId>a3c0f31a-4a14-447b-88be-1db6c2dcd187</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="124"
                  trans_unit_id="124-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="124">
            <SegmentId>a3c0f31a-4a14-447b-88be-1db6c2dcd187</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="124"
              trans_unit_id="124-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="122c1789-ea0b-453c-8302-33e584fbecab"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="122c1789-ea0b-453c-8302-33e584fbecab">
        <Lines>
          <MarkdownLine>
            <LineId>c872ff73-33ef-4045-9615-0e05054c9ec7</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="125">
                <SegmentId>2dc2d762-2c76-4eef-a9a6-60b6b7a98cef</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="125"
                  trans_unit_id="125-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="126">
                <SegmentId>2dedd3de-afdd-4cbc-9594-0e1cbf2d1f38</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="126"
                  trans_unit_id="126-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="127">
                <SegmentId>eafc8f6f-d438-4ecd-9a45-285926551297</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="127"
                  trans_unit_id="127-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="128">
                <SegmentId>5d80e604-0367-4134-9a6d-b9847cd0ff8a</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="128"
                  trans_unit_id="128-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="125">
            <SegmentId>2dc2d762-2c76-4eef-a9a6-60b6b7a98cef</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="125"
              trans_unit_id="125-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="126">
            <SegmentId>2dedd3de-afdd-4cbc-9594-0e1cbf2d1f38</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="126"
              trans_unit_id="126-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="127">
            <SegmentId>eafc8f6f-d438-4ecd-9a45-285926551297</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="127"
              trans_unit_id="127-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="128">
            <SegmentId>5d80e604-0367-4134-9a6d-b9847cd0ff8a</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="128"
              trans_unit_id="128-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="f921542d-b555-4858-8c97-bb3ac0cc7f64"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="f921542d-b555-4858-8c97-bb3ac0cc7f64">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>CREATE TABLE #Cube
WITH 
(   DISTRIBUTION = ROUND_ROBIN
,   LOCATION = USER_DB
)
AS
WITH GrpCube AS
(SELECT    CAST(ISNULL(Country,'NULL')+','+ISNULL(Region,'NULL') AS NVARCHAR(50)) as 'Cols'
,          CAST(ISNULL(Country+',','')+ISNULL(Region,'') AS NVARCHAR(50))  as 'GroupBy'
,          ROW_NUMBER() OVER (ORDER BY Country) as 'Seq'
FROM       ( SELECT 'SalesTerritoryCountry' as Country
             UNION ALL
             SELECT NULL
           ) c
CROSS JOIN ( SELECT 'SalesTerritoryRegion' as Region
             UNION ALL
             SELECT NULL
           ) r
)
SELECT Cols
,      CASE WHEN SUBSTRING(GroupBy,LEN(GroupBy),1) = ',' 
            THEN SUBSTRING(GroupBy,1,LEN(GroupBy)-1) 
            ELSE GroupBy 
       END AS GroupBy  --Remove Trailing Comma
,Seq
FROM GrpCube;</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="22ae5937-26f8-4e27-a36a-f9c6d7b52100"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="22ae5937-26f8-4e27-a36a-f9c6d7b52100">
        <Lines>
          <MarkdownLine>
            <LineId>814c9eb7-296d-48de-bc76-861ea44174e3</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="129">
                <SegmentId>f0a54975-1646-4d1a-ab1b-1c467a412bf3</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="129"
                  trans_unit_id="129-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="129">
            <SegmentId>f0a54975-1646-4d1a-ab1b-1c467a412bf3</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="129"
              trans_unit_id="129-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="bf09b840-fa95-43e2-892b-c3ca7b5aa69e"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="bf09b840-fa95-43e2-892b-c3ca7b5aa69e">
        <Lines>
          <MarkdownLine>
            <LineId>3536585d-5b1e-4096-aa19-401d87bf45ec</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="130">
                <SegmentId>90abd553-b9b5-4faf-9ffd-86e2aaa6bcee</SegmentId>
                <ImageItem
                  internal_item_id="1"
                  internal_item_parent_id="130"
                  trans_unit_id="130-1"
                  internal_item_type="Image">
                  <internal_items />
                  <internal_Image_type>Reference</internal_Image_type>
                  <internal_link_text />
                  <internal_link_id>1</internal_link_id>
                </ImageItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="130">
            <SegmentId>90abd553-b9b5-4faf-9ffd-86e2aaa6bcee</SegmentId>
            <ImageItem
              internal_item_id="1"
              internal_item_parent_id="130"
              trans_unit_id="130-1"
              internal_item_type="Image">
              <internal_items />
              <internal_Image_type>Reference</internal_Image_type>
              <internal_link_text />
              <internal_link_id>1</internal_link_id>
            </ImageItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="fbe0d370-8d6a-44c9-9c22-80ed2b00ecee"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="fbe0d370-8d6a-44c9-9c22-80ed2b00ecee">
        <Lines>
          <MarkdownLine>
            <LineId>bad003d9-2783-499d-809c-e87b2f7411ac</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="131">
                <SegmentId>3e1dab1c-8610-4c68-bfac-5429b3d8a51f</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="131"
                  trans_unit_id="131-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="131">
            <SegmentId>3e1dab1c-8610-4c68-bfac-5429b3d8a51f</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="131"
              trans_unit_id="131-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="69cf98b7-f783-4c48-a76a-ae1627b51396"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="69cf98b7-f783-4c48-a76a-ae1627b51396">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block> @SQL NVARCHAR(4000)
,@Columns NVARCHAR(4000)
,@GroupBy NVARCHAR(4000)
,@i INT = 1
,@nbr INT = 0
;
CREATE TABLE #Results
(
 [SalesTerritoryCountry] NVARCHAR(50)
,[SalesTerritoryRegion]  NVARCHAR(50)
,[TotalSalesAmount]      MONEY
)
WITH
(   DISTRIBUTION = ROUND_ROBIN
,   LOCATION = USER_DB
)
;</code_block>
        <fenced_code_lang>
DECLARE </fenced_code_lang>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="b6a1fd16-ab44-4d40-90d2-b064d96291c6"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="b6a1fd16-ab44-4d40-90d2-b064d96291c6">
        <Lines>
          <MarkdownLine>
            <LineId>2995d492-0953-48b6-abe4-5a9718bb891f</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="132">
                <SegmentId>51a33ec4-379a-413e-9464-5ae28a66e9ab</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="132"
                  trans_unit_id="132-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
              <MarkdownSegment
                trans_unit_id="133">
                <SegmentId>c0693958-a9f9-41da-98f6-7932ab6cafd6</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="133"
                  trans_unit_id="133-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="132">
            <SegmentId>51a33ec4-379a-413e-9464-5ae28a66e9ab</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="132"
              trans_unit_id="132-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment
            trans_unit_id="133">
            <SegmentId>c0693958-a9f9-41da-98f6-7932ab6cafd6</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="133"
              trans_unit_id="133-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="bad83e64-e893-4cf4-b838-57fb488aebe0"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="bad83e64-e893-4cf4-b838-57fb488aebe0">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>SET @nbr =(SELECT MAX(Seq) FROM #Cube);

WHILE @i&lt;=@nbr
BEGIN
    SET @Columns = (SELECT Cols    FROM #Cube where seq = @i);
    SET @GroupBy = (SELECT GroupBy FROM #Cube where seq = @i);

    SET @SQL ='INSERT INTO #Results
              SELECT '+@Columns+'
              ,      SUM(SalesAmount) AS TotalSalesAmount
              FROM  dbo.factInternetSales s
              JOIN  dbo.DimSalesTerritory t  
              ON s.SalesTerritoryKey = t.SalesTerritoryKey
              '+CASE WHEN @GroupBy &lt;&gt;'' 
                     THEN 'GROUP BY '+@GroupBy ELSE '' END

    EXEC sp_executesql @SQL;
    SET @i +=1;
END</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="66f4a62c-20e6-4845-bd06-3c5e17f24fe3"
        item_type="NormalParagraph"
        item_footer=""
        trans_unit_id="66f4a62c-20e6-4845-bd06-3c5e17f24fe3">
        <Lines>
          <MarkdownLine>
            <LineId>003947af-654f-4906-8229-2d6d4aba1967</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="134">
                <SegmentId>24f3fa9d-980c-41ed-a13e-ea4c91d1ff08</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="134"
                  trans_unit_id="134-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="134">
            <SegmentId>24f3fa9d-980c-41ed-a13e-ea4c91d1ff08</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="134"
              trans_unit_id="134-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="f65f517b-1cf1-473a-b3ed-99bc4903bb03"
        item_type="FencedCodeBlock"
        item_footer=""
        trans_unit_id="f65f517b-1cf1-473a-b3ed-99bc4903bb03">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>SELECT * 
FROM #Results
ORDER BY 1,2,3
;</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="c4709805-337b-48f0-af30-c57e5c0c2000"
        item_type="NormalParagraph"
        item_footer="&#xA;"
        trans_unit_id="c4709805-337b-48f0-af30-c57e5c0c2000">
        <Lines>
          <MarkdownLine>
            <LineId>f94217f6-e537-47fb-b655-0ccb3a4bc13b</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="135">
                <SegmentId>8e07c02e-6b06-46ff-9c61-de3fcdb6ccca</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="135"
                  trans_unit_id="135-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="135">
            <SegmentId>8e07c02e-6b06-46ff-9c61-de3fcdb6ccca</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="135"
              trans_unit_id="135-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="f6fe766f-79ef-4668-82b2-627b0ac903dd"
        item_type="Header"
        item_footer="footer_not_set"
        trans_unit_id="f6fe766f-79ef-4668-82b2-627b0ac903dd">
        <segment
          trans_unit_id="136">
          <SegmentId>58b6ef1d-1ea0-4dff-9415-f15dc26e6f47</SegmentId>
          <InternalNormalItem
            internal_item_id="1"
            internal_item_parent_id="136"
            trans_unit_id="136-1"
            internal_item_type="Normal">
            <internal_items />
          </InternalNormalItem>
        </segment>
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="e91baa81-30ad-4e8e-968b-979c8367012b"
        item_type="NormalParagraph"
        item_footer="&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;"
        trans_unit_id="e91baa81-30ad-4e8e-968b-979c8367012b">
        <Lines>
          <MarkdownLine>
            <LineId>0164494c-02e3-4f38-812e-02e40f04c720</LineId>
            <paragraph_segments>
              <MarkdownSegment
                trans_unit_id="137">
                <SegmentId>60b73500-1dcc-4953-b9e8-3964b3aa2853</SegmentId>
                <InternalNormalItem
                  internal_item_id="1"
                  internal_item_parent_id="137"
                  trans_unit_id="137-1"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
                <LinkItem
                  internal_item_id="2"
                  internal_item_parent_id="137"
                  trans_unit_id="137-2"
                  internal_item_type="Link">
                  <internal_items />
                  <internal_link_type>Reference</internal_link_type>
                  <internal_link_text>development overview</internal_link_text>
                  <internal_link_id />
                </LinkItem>
                <InternalNormalItem
                  internal_item_id="3"
                  internal_item_parent_id="137"
                  trans_unit_id="137-3"
                  internal_item_type="Normal">
                  <internal_items />
                </InternalNormalItem>
              </MarkdownSegment>
            </paragraph_segments>
            <PrefixWSLength>0</PrefixWSLength>
            <SuffixWSLength>0</SuffixWSLength>
          </MarkdownLine>
        </Lines>
        <paragraph_segments>
          <MarkdownSegment
            trans_unit_id="137">
            <SegmentId>60b73500-1dcc-4953-b9e8-3964b3aa2853</SegmentId>
            <InternalNormalItem
              internal_item_id="1"
              internal_item_parent_id="137"
              trans_unit_id="137-1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
            <LinkItem
              internal_item_id="2"
              internal_item_parent_id="137"
              trans_unit_id="137-2"
              internal_item_type="Link">
              <internal_items />
              <internal_link_type>Reference</internal_link_type>
              <internal_link_text>development overview</internal_link_text>
              <internal_link_id />
            </LinkItem>
            <InternalNormalItem
              internal_item_id="3"
              internal_item_parent_id="137"
              trans_unit_id="137-3"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
    </ArrayOfMarkdownBlockBase>
  </block_element>
  <references>
    <ArrayOfMarkdownLinkedReference xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <MarkdownLinkedReference
        item_id="985bf4f3-e326-44a9-b295-fb747ee174be"
        item_type="LinkedReference"
        item_footer="footer_not_set"
        trans_unit_id="985bf4f3-e326-44a9-b295-fb747ee174be">
        <link_id>1</link_id>
        <link_uri>media/sql-data-warehouse-develop-group-by-options/sql-data-warehouse-develop-group-by-cube.png</link_uri>
        <link_title />
      </MarkdownLinkedReference>
      <MarkdownLinkedReference
        item_id="b26adac0-511c-45e5-b833-5a6b395b731b"
        item_type="LinkedReference"
        item_footer="footer_not_set"
        trans_unit_id="b26adac0-511c-45e5-b833-5a6b395b731b">
        <link_id>development overview</link_id>
        <link_uri>sql-data-warehouse-overview-develop.md</link_uri>
        <link_title />
      </MarkdownLinkedReference>
      <MarkdownLinkedReference
        item_id="7651b9d5-86b4-4819-a902-af5e884e3b3d"
        item_type="LinkedReference"
        item_footer="footer_not_set"
        trans_unit_id="7651b9d5-86b4-4819-a902-af5e884e3b3d">
        <link_id>group by</link_id>
        <link_uri>https://msdn.microsoft.com/en-us/library/ms177673.aspx</link_uri>
        <link_title />
      </MarkdownLinkedReference>
    </ArrayOfMarkdownLinkedReference>
  </references>
</markdown_skeleton_root>